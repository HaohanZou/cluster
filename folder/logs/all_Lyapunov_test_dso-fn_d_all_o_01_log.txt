MainProcess| 2024-07-21 21:04:48,716,716 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:04:48,716,716 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:04:48,716,716 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:04:48,717,717 multiprocessing INFO                variables   expression              train_spec test_spec function_set
name                                                                                
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[1,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:04:48,830,830 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:04:48,831,831 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:04:48,891,891 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:04:48,896,896 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:04:49,780,780 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:04:49,787,787 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-210448', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-210448_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:04:52,755,755 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=7688.74561 	| eqs_invalid %=3.40 	| r_best=0.53208 	| quantile=0.40588 	| r_quantile_mean=0.46589 	| r_raw_sum=96.93928 	|  r_raw_mean=0.20070 	| r2=0.69333 	| acc_iid=0.22388 	| acc_ood=0.02985 	| nmse_test=0.5737845525510514 	| true_equation_set_count=0 	| s/it=2.96217
MainProcess| 2024-07-21 21:04:52,755,755 multiprocessing INFO [00:00:00:02.96] Training epoch 1/4000, current best R: 0.5321
MainProcess| 2024-07-21 21:04:52,755,755 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:04:52,755,755 multiprocessing INFO 	Reward: 0.5320773548325566
MainProcess| 2024-07-21 21:04:52,755,755 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:04:52,755,755 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:04:52,756,756 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:04:52,756,756 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:04:52,756,756 multiprocessing INFO 	Traversal: add,add,add,cos,div,n2,div,mul,mul,x2,add,x1,x2,sub,x2,x1,sub,x1,x2,x1,x2,x1,x1
MainProcess| 2024-07-21 21:04:52,756,756 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:04:52,894,894 multiprocessing INFO 
	                 ⎛  2           2          2⎞
	                 ⎜x₂ ⋅(-x₁ + x₂) ⋅(x₁ + x₂) ⎟
	  2⋅x₁ + x₂ + cos⎜──────────────────────────⎟
	                 ⎜                  2       ⎟
	                 ⎝      x₁⋅(x₁ - x₂)        ⎠

MainProcess| 2024-07-21 21:04:53,129,129 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=7655.02246 	| eqs_invalid %=2.40 	| r_best=0.59069 	| quantile=0.41226 	| r_quantile_mean=0.45365 	| r_raw_sum=95.39883 	|  r_raw_mean=0.19549 	| r2=0.85446 	| acc_iid=0.28358 	| acc_ood=0.22388 	| nmse_test=0.3373427844999079 	| true_equation_set_count=0 	| s/it=0.23472
MainProcess| 2024-07-21 21:04:53,129,129 multiprocessing INFO [00:00:00:03.34] Training epoch 2/4000, current best R: 0.5907
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Reward: 0.5906875611405512
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Traversal: add,n2,x2,add,n2,sin,n2,sub,add,div,n2,n2,x1,x1,x1,mul,x1,x2,x1
MainProcess| 2024-07-21 21:04:53,130,130 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:04:53,136,136 multiprocessing INFO 
	                 ⎛                  2⎞
	         2      2⎜⎛  3             ⎞ ⎟
	  x₁ + x₂  + sin ⎝⎝x₁  - x₁⋅x₂ + x₁⎠ ⎠

MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=6849.27051 	| eqs_invalid %=1.80 	| r_best=0.79160 	| quantile=0.46797 	| r_quantile_mean=0.56219 	| r_raw_sum=97.85917 	|  r_raw_mean=0.19931 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.23504
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO [00:00:00:03.58] Training epoch 3/4000, current best R: 0.7916
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Reward: 0.7915971567830407
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Traversal: mul,sub,x1,sub,n2,sin,sub,add,div,x2,mul,add,add,x1,x1,add,x1,x1,x2,x1,x1,x1,x2
MainProcess| 2024-07-21 21:04:53,371,371 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:04:53,378,378 multiprocessing INFO 
	     ⎛          2⎛ 1  ⎞⎞
	  x₂⋅⎜2⋅x₁ - sin ⎜────⎟⎟
	     ⎝           ⎝4⋅x₁⎠⎠

MainProcess| 2024-07-21 21:04:53,608,608 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=7603.89795 	| eqs_invalid %=4.00 	| r_best=0.79160 	| quantile=0.44553 	| r_quantile_mean=0.49785 	| r_raw_sum=93.25719 	|  r_raw_mean=0.19429 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.22940
MainProcess| 2024-07-21 21:04:53,840,840 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=6800.90039 	| eqs_invalid %=2.60 	| r_best=0.79160 	| quantile=0.43494 	| r_quantile_mean=0.49631 	| r_raw_sum=96.18513 	|  r_raw_mean=0.19751 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.23206
MainProcess| 2024-07-21 21:04:54,066,66 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=6767.71338 	| eqs_invalid %=2.60 	| r_best=0.79160 	| quantile=0.47989 	| r_quantile_mean=0.56495 	| r_raw_sum=97.41250 	|  r_raw_mean=0.20003 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.22624
MainProcess| 2024-07-21 21:04:54,297,297 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=6725.94971 	| eqs_invalid %=2.20 	| r_best=0.79160 	| quantile=0.46601 	| r_quantile_mean=0.51890 	| r_raw_sum=98.39054 	|  r_raw_mean=0.20121 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.23019
MainProcess| 2024-07-21 21:04:54,528,528 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6474.93164 	| eqs_invalid %=2.00 	| r_best=0.79160 	| quantile=0.43298 	| r_quantile_mean=0.52204 	| r_raw_sum=99.21055 	|  r_raw_mean=0.20247 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.23121
MainProcess| 2024-07-21 21:04:54,878,878 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=6634.60938 	| eqs_invalid %=2.00 	| r_best=0.79160 	| quantile=0.44785 	| r_quantile_mean=0.53517 	| r_raw_sum=98.87574 	|  r_raw_mean=0.20179 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.34942
MainProcess| 2024-07-21 21:04:55,113,113 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7295.22314 	| eqs_invalid %=2.20 	| r_best=0.79160 	| quantile=0.41433 	| r_quantile_mean=0.48597 	| r_raw_sum=94.77277 	|  r_raw_mean=0.19381 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.23547
MainProcess| 2024-07-21 21:04:55,113,113 multiprocessing INFO [00:00:00:05.32] Training epoch 10/4000, current best R: 0.7916
MainProcess| 2024-07-21 21:04:55,341,341 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=7016.85254 	| eqs_invalid %=1.80 	| r_best=0.79160 	| quantile=0.45800 	| r_quantile_mean=0.51588 	| r_raw_sum=97.72846 	|  r_raw_mean=0.19904 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.22796
MainProcess| 2024-07-21 21:04:55,601,601 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=7093.85693 	| eqs_invalid %=1.20 	| r_best=0.79160 	| quantile=0.41014 	| r_quantile_mean=0.53076 	| r_raw_sum=98.20300 	|  r_raw_mean=0.19879 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.25940
MainProcess| 2024-07-21 21:04:55,827,827 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6798.64600 	| eqs_invalid %=1.60 	| r_best=0.79160 	| quantile=0.48729 	| r_quantile_mean=0.51066 	| r_raw_sum=96.59859 	|  r_raw_mean=0.19634 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.22648
MainProcess| 2024-07-21 21:04:56,059,59 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=6563.99561 	| eqs_invalid %=2.00 	| r_best=0.79160 	| quantile=0.43109 	| r_quantile_mean=0.49889 	| r_raw_sum=97.36874 	|  r_raw_mean=0.19871 	| r2=0.99065 	| acc_iid=0.79104 	| acc_ood=0.26866 	| nmse_test=0.03991669205192657 	| true_equation_set_count=0 	| s/it=0.23101
MainProcess| 2024-07-21 21:04:56,294,294 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6366.12061 	| eqs_invalid %=2.40 	| r_best=0.79934 	| quantile=0.46635 	| r_quantile_mean=0.58876 	| r_raw_sum=97.51299 	|  r_raw_mean=0.19982 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23548
MainProcess| 2024-07-21 21:04:56,294,294 multiprocessing INFO [00:00:00:06.50] Training epoch 15/4000, current best R: 0.7993
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Reward: 0.7993387850758384
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Traversal: add,sub,x1,div,cos,n2,x1,x1,add,sub,x2,mul,cos,sub,add,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:04:56,295,295 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:04:56,299,299 multiprocessing INFO 
	                               ⎛  2⎞
	                            cos⎝x₁ ⎠
	  -x₁⋅cos(x₂) + 2⋅x₁ + x₂ - ────────
	                               x₁   

MainProcess| 2024-07-21 21:04:56,535,535 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6327.06201 	| eqs_invalid %=2.60 	| r_best=0.79934 	| quantile=0.41955 	| r_quantile_mean=0.51063 	| r_raw_sum=96.99817 	|  r_raw_mean=0.19917 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23580
MainProcess| 2024-07-21 21:04:56,780,780 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=7735.41455 	| eqs_invalid %=1.80 	| r_best=0.79934 	| quantile=0.52317 	| r_quantile_mean=0.57948 	| r_raw_sum=101.28546 	|  r_raw_mean=0.20628 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.24421
MainProcess| 2024-07-21 21:04:57,014,14 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7086.70898 	| eqs_invalid %=1.60 	| r_best=0.79934 	| quantile=0.45195 	| r_quantile_mean=0.51428 	| r_raw_sum=98.11662 	|  r_raw_mean=0.19942 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23478
MainProcess| 2024-07-21 21:04:57,254,254 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=6664.51904 	| eqs_invalid %=2.00 	| r_best=0.79934 	| quantile=0.45434 	| r_quantile_mean=0.51047 	| r_raw_sum=97.26274 	|  r_raw_mean=0.19850 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23939
MainProcess| 2024-07-21 21:04:57,488,488 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=6628.30811 	| eqs_invalid %=1.40 	| r_best=0.79934 	| quantile=0.47182 	| r_quantile_mean=0.54251 	| r_raw_sum=98.34310 	|  r_raw_mean=0.19948 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23356
MainProcess| 2024-07-21 21:04:57,488,488 multiprocessing INFO [00:00:00:07.70] Training epoch 20/4000, current best R: 0.7993
MainProcess| 2024-07-21 21:04:57,727,727 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=7326.85498 	| eqs_invalid %=1.20 	| r_best=0.79934 	| quantile=0.47359 	| r_quantile_mean=0.56059 	| r_raw_sum=101.62096 	|  r_raw_mean=0.20571 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23919
MainProcess| 2024-07-21 21:04:57,958,958 multiprocessing INFO [Test epoch=0022]  nevals=11000 	| train_loss=7486.04346 	| eqs_invalid %=1.60 	| r_best=0.79934 	| quantile=0.48846 	| r_quantile_mean=0.53031 	| r_raw_sum=98.29148 	|  r_raw_mean=0.19978 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23068
MainProcess| 2024-07-21 21:04:58,197,197 multiprocessing INFO [Test epoch=0023]  nevals=11500 	| train_loss=7194.07764 	| eqs_invalid %=0.60 	| r_best=0.79934 	| quantile=0.50230 	| r_quantile_mean=0.55752 	| r_raw_sum=103.22426 	|  r_raw_mean=0.20769 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23867
MainProcess| 2024-07-21 21:04:58,436,436 multiprocessing INFO [Test epoch=0024]  nevals=12000 	| train_loss=6989.81836 	| eqs_invalid %=1.20 	| r_best=0.79934 	| quantile=0.43738 	| r_quantile_mean=0.50588 	| r_raw_sum=98.39682 	|  r_raw_mean=0.19918 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23864
MainProcess| 2024-07-21 21:04:58,674,674 multiprocessing INFO [Test epoch=0025]  nevals=12500 	| train_loss=7202.34082 	| eqs_invalid %=2.60 	| r_best=0.79934 	| quantile=0.43083 	| r_quantile_mean=0.50211 	| r_raw_sum=94.74885 	|  r_raw_mean=0.19456 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23811
MainProcess| 2024-07-21 21:04:58,914,914 multiprocessing INFO [Test epoch=0026]  nevals=13000 	| train_loss=6983.65332 	| eqs_invalid %=2.20 	| r_best=0.79934 	| quantile=0.45702 	| r_quantile_mean=0.51202 	| r_raw_sum=101.53591 	|  r_raw_mean=0.20764 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23943
MainProcess| 2024-07-21 21:04:59,158,158 multiprocessing INFO [Test epoch=0027]  nevals=13500 	| train_loss=8143.08350 	| eqs_invalid %=2.00 	| r_best=0.79934 	| quantile=0.48363 	| r_quantile_mean=0.55451 	| r_raw_sum=97.01153 	|  r_raw_mean=0.19798 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.24395
MainProcess| 2024-07-21 21:04:59,394,394 multiprocessing INFO [Test epoch=0028]  nevals=14000 	| train_loss=6056.09814 	| eqs_invalid %=1.60 	| r_best=0.79934 	| quantile=0.48689 	| r_quantile_mean=0.55486 	| r_raw_sum=100.65741 	|  r_raw_mean=0.20459 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.23577
MainProcess| 2024-07-21 21:04:59,620,620 multiprocessing INFO [Test epoch=0029]  nevals=14500 	| train_loss=7586.33887 	| eqs_invalid %=2.60 	| r_best=0.79934 	| quantile=0.43438 	| r_quantile_mean=0.54254 	| r_raw_sum=101.02855 	|  r_raw_mean=0.20745 	| r2=0.97608 	| acc_iid=0.58209 	| acc_ood=0.07463 	| nmse_test=0.052287827433718195 	| true_equation_set_count=0 	| s/it=0.22566
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO [Test epoch=0030]  nevals=15000 	| train_loss=6429.81592 	| eqs_invalid %=0.80 	| r_best=0.84698 	| quantile=0.43903 	| r_quantile_mean=0.54156 	| r_raw_sum=98.08246 	|  r_raw_mean=0.19775 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23109
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO [00:00:00:10.06] Training epoch 30/4000, current best R: 0.8470
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Reward: 0.8469844581043969
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Traversal: div,mul,x2,mul,mul,div,sub,add,add,div,x1,sin,div,mul,x2,x1,x2,x2,x1,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:04:59,851,851 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:04:59,857,857 multiprocessing INFO 
	     ⎛        x₁  ⎞
	  x₂⋅⎜x₁ + ───────⎟
	     ⎝     sin(x₁)⎠

MainProcess| 2024-07-21 21:04:59,857,857 multiprocessing INFO [00:00:00:10.06] Training epoch 30/4000, current best R: 0.8470
MainProcess| 2024-07-21 21:05:00,096,96 multiprocessing INFO [Test epoch=0031]  nevals=15500 	| train_loss=7204.33105 	| eqs_invalid %=1.60 	| r_best=0.84698 	| quantile=0.47106 	| r_quantile_mean=0.55694 	| r_raw_sum=99.58963 	|  r_raw_mean=0.20242 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23939
MainProcess| 2024-07-21 21:05:00,334,334 multiprocessing INFO [Test epoch=0032]  nevals=16000 	| train_loss=5984.21582 	| eqs_invalid %=1.40 	| r_best=0.84698 	| quantile=0.45821 	| r_quantile_mean=0.52926 	| r_raw_sum=103.26059 	|  r_raw_mean=0.20945 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23724
MainProcess| 2024-07-21 21:05:00,557,557 multiprocessing INFO [Test epoch=0033]  nevals=16500 	| train_loss=6654.09229 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.44884 	| r_quantile_mean=0.52833 	| r_raw_sum=100.81814 	|  r_raw_mean=0.20409 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.22330
MainProcess| 2024-07-21 21:05:00,787,787 multiprocessing INFO [Test epoch=0034]  nevals=17000 	| train_loss=7103.53662 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.48218 	| r_quantile_mean=0.59724 	| r_raw_sum=100.77726 	|  r_raw_mean=0.20525 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.22975
MainProcess| 2024-07-21 21:05:01,040,40 multiprocessing INFO [Test epoch=0035]  nevals=17500 	| train_loss=6503.21533 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.51019 	| r_quantile_mean=0.57118 	| r_raw_sum=102.78625 	|  r_raw_mean=0.20807 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25332
MainProcess| 2024-07-21 21:05:01,289,289 multiprocessing INFO [Test epoch=0036]  nevals=18000 	| train_loss=7081.22070 	| eqs_invalid %=1.40 	| r_best=0.84698 	| quantile=0.41781 	| r_quantile_mean=0.51207 	| r_raw_sum=100.10020 	|  r_raw_mean=0.20304 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.24843
MainProcess| 2024-07-21 21:05:01,561,561 multiprocessing INFO [Test epoch=0037]  nevals=18500 	| train_loss=7729.34717 	| eqs_invalid %=0.80 	| r_best=0.84698 	| quantile=0.48375 	| r_quantile_mean=0.55835 	| r_raw_sum=101.36771 	|  r_raw_mean=0.20437 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.27211
MainProcess| 2024-07-21 21:05:01,807,807 multiprocessing INFO [Test epoch=0038]  nevals=19000 	| train_loss=7716.27100 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.48800 	| r_quantile_mean=0.56164 	| r_raw_sum=101.75747 	|  r_raw_mean=0.20599 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.24528
MainProcess| 2024-07-21 21:05:02,062,62 multiprocessing INFO [Test epoch=0039]  nevals=19500 	| train_loss=7692.51025 	| eqs_invalid %=1.40 	| r_best=0.84698 	| quantile=0.52402 	| r_quantile_mean=0.56193 	| r_raw_sum=101.61965 	|  r_raw_mean=0.20613 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25559
MainProcess| 2024-07-21 21:05:02,324,324 multiprocessing INFO [Test epoch=0040]  nevals=20000 	| train_loss=7573.12012 	| eqs_invalid %=0.60 	| r_best=0.84698 	| quantile=0.51168 	| r_quantile_mean=0.58329 	| r_raw_sum=104.39811 	|  r_raw_mean=0.21006 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26186
MainProcess| 2024-07-21 21:05:02,325,325 multiprocessing INFO [00:00:00:12.53] Training epoch 40/4000, current best R: 0.8470
MainProcess| 2024-07-21 21:05:02,611,611 multiprocessing INFO [Test epoch=0041]  nevals=20500 	| train_loss=6707.77051 	| eqs_invalid %=0.80 	| r_best=0.84698 	| quantile=0.49279 	| r_quantile_mean=0.58131 	| r_raw_sum=102.83930 	|  r_raw_mean=0.20734 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.28596
MainProcess| 2024-07-21 21:05:02,865,865 multiprocessing INFO [Test epoch=0042]  nevals=21000 	| train_loss=7005.73486 	| eqs_invalid %=1.00 	| r_best=0.84698 	| quantile=0.53724 	| r_quantile_mean=0.55925 	| r_raw_sum=101.75268 	|  r_raw_mean=0.20556 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25469
MainProcess| 2024-07-21 21:05:03,106,106 multiprocessing INFO [Test epoch=0043]  nevals=21500 	| train_loss=6907.40527 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.48767 	| r_quantile_mean=0.53545 	| r_raw_sum=101.60378 	|  r_raw_mean=0.20568 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.24001
MainProcess| 2024-07-21 21:05:03,377,377 multiprocessing INFO [Test epoch=0044]  nevals=22000 	| train_loss=6883.33740 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.51864 	| r_quantile_mean=0.54499 	| r_raw_sum=105.75841 	|  r_raw_mean=0.21409 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.27090
MainProcess| 2024-07-21 21:05:03,638,638 multiprocessing INFO [Test epoch=0045]  nevals=22500 	| train_loss=6988.06494 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.51596 	| r_quantile_mean=0.57213 	| r_raw_sum=103.61732 	|  r_raw_mean=0.21103 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26115
MainProcess| 2024-07-21 21:05:03,876,876 multiprocessing INFO [Test epoch=0046]  nevals=23000 	| train_loss=6718.67773 	| eqs_invalid %=2.40 	| r_best=0.84698 	| quantile=0.46754 	| r_quantile_mean=0.50823 	| r_raw_sum=98.08641 	|  r_raw_mean=0.20100 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23798
MainProcess| 2024-07-21 21:05:04,141,141 multiprocessing INFO [Test epoch=0047]  nevals=23500 	| train_loss=7464.31201 	| eqs_invalid %=1.40 	| r_best=0.84698 	| quantile=0.49310 	| r_quantile_mean=0.53673 	| r_raw_sum=104.15238 	|  r_raw_mean=0.21126 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26501
MainProcess| 2024-07-21 21:05:04,394,394 multiprocessing INFO [Test epoch=0048]  nevals=24000 	| train_loss=7536.45264 	| eqs_invalid %=2.00 	| r_best=0.84698 	| quantile=0.46527 	| r_quantile_mean=0.54127 	| r_raw_sum=99.91469 	|  r_raw_mean=0.20391 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25247
MainProcess| 2024-07-21 21:05:04,622,622 multiprocessing INFO [Test epoch=0049]  nevals=24500 	| train_loss=7221.49902 	| eqs_invalid %=1.60 	| r_best=0.84698 	| quantile=0.50999 	| r_quantile_mean=0.58821 	| r_raw_sum=103.59926 	|  r_raw_mean=0.21057 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.22816
MainProcess| 2024-07-21 21:05:04,884,884 multiprocessing INFO [Test epoch=0050]  nevals=25000 	| train_loss=7418.38818 	| eqs_invalid %=2.20 	| r_best=0.84698 	| quantile=0.52239 	| r_quantile_mean=0.59069 	| r_raw_sum=101.40735 	|  r_raw_mean=0.20738 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26210
MainProcess| 2024-07-21 21:05:04,885,885 multiprocessing INFO [00:00:00:15.09] Training epoch 50/4000, current best R: 0.8470
MainProcess| 2024-07-21 21:05:05,150,150 multiprocessing INFO [Test epoch=0051]  nevals=25500 	| train_loss=7189.82031 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.56180 	| r_quantile_mean=0.59760 	| r_raw_sum=104.85491 	|  r_raw_mean=0.21355 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26554
MainProcess| 2024-07-21 21:05:05,383,383 multiprocessing INFO [Test epoch=0052]  nevals=26000 	| train_loss=6658.91260 	| eqs_invalid %=2.60 	| r_best=0.84698 	| quantile=0.52998 	| r_quantile_mean=0.58587 	| r_raw_sum=104.89374 	|  r_raw_mean=0.21539 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23214
MainProcess| 2024-07-21 21:05:05,614,614 multiprocessing INFO [Test epoch=0053]  nevals=26500 	| train_loss=6646.01855 	| eqs_invalid %=2.80 	| r_best=0.84698 	| quantile=0.49708 	| r_quantile_mean=0.55029 	| r_raw_sum=103.36733 	|  r_raw_mean=0.21269 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23107
MainProcess| 2024-07-21 21:05:06,010,10 multiprocessing INFO [Test epoch=0054]  nevals=27000 	| train_loss=6941.28027 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.51623 	| r_quantile_mean=0.55145 	| r_raw_sum=103.30662 	|  r_raw_mean=0.21040 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.39576
MainProcess| 2024-07-21 21:05:06,260,260 multiprocessing INFO [Test epoch=0055]  nevals=27500 	| train_loss=7372.62354 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.50391 	| r_quantile_mean=0.57210 	| r_raw_sum=101.50916 	|  r_raw_mean=0.20674 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25065
MainProcess| 2024-07-21 21:05:06,558,558 multiprocessing INFO [Test epoch=0056]  nevals=28000 	| train_loss=7361.57227 	| eqs_invalid %=1.60 	| r_best=0.84698 	| quantile=0.49669 	| r_quantile_mean=0.60408 	| r_raw_sum=108.18649 	|  r_raw_mean=0.21989 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.29785
MainProcess| 2024-07-21 21:05:06,802,802 multiprocessing INFO [Test epoch=0057]  nevals=28500 	| train_loss=7141.05518 	| eqs_invalid %=1.40 	| r_best=0.84698 	| quantile=0.43037 	| r_quantile_mean=0.50757 	| r_raw_sum=99.35045 	|  r_raw_mean=0.20152 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.24320
MainProcess| 2024-07-21 21:05:07,059,59 multiprocessing INFO [Test epoch=0058]  nevals=29000 	| train_loss=6495.42676 	| eqs_invalid %=2.20 	| r_best=0.84698 	| quantile=0.55417 	| r_quantile_mean=0.59599 	| r_raw_sum=103.64792 	|  r_raw_mean=0.21196 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25758
MainProcess| 2024-07-21 21:05:07,338,338 multiprocessing INFO [Test epoch=0059]  nevals=29500 	| train_loss=6930.93994 	| eqs_invalid %=2.20 	| r_best=0.84698 	| quantile=0.51440 	| r_quantile_mean=0.58966 	| r_raw_sum=103.29650 	|  r_raw_mean=0.21124 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.27836
MainProcess| 2024-07-21 21:05:07,633,633 multiprocessing INFO [Test epoch=0060]  nevals=30000 	| train_loss=6745.87988 	| eqs_invalid %=2.20 	| r_best=0.84698 	| quantile=0.49497 	| r_quantile_mean=0.56001 	| r_raw_sum=103.79398 	|  r_raw_mean=0.21226 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.29477
MainProcess| 2024-07-21 21:05:07,633,633 multiprocessing INFO [00:00:00:17.84] Training epoch 60/4000, current best R: 0.8470
MainProcess| 2024-07-21 21:05:07,930,930 multiprocessing INFO [Test epoch=0061]  nevals=30500 	| train_loss=6913.79346 	| eqs_invalid %=2.80 	| r_best=0.84698 	| quantile=0.48534 	| r_quantile_mean=0.56408 	| r_raw_sum=100.96501 	|  r_raw_mean=0.20775 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.29653
MainProcess| 2024-07-21 21:05:08,205,205 multiprocessing INFO [Test epoch=0062]  nevals=31000 	| train_loss=6979.73584 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.51037 	| r_quantile_mean=0.56361 	| r_raw_sum=100.82943 	|  r_raw_mean=0.20536 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.27570
MainProcess| 2024-07-21 21:05:08,458,458 multiprocessing INFO [Test epoch=0063]  nevals=31500 	| train_loss=6506.13281 	| eqs_invalid %=1.80 	| r_best=0.84698 	| quantile=0.45729 	| r_quantile_mean=0.52014 	| r_raw_sum=100.70703 	|  r_raw_mean=0.20511 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25261
MainProcess| 2024-07-21 21:05:08,704,704 multiprocessing INFO [Test epoch=0064]  nevals=32000 	| train_loss=6874.79639 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.49045 	| r_quantile_mean=0.55187 	| r_raw_sum=103.66971 	|  r_raw_mean=0.20986 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.24577
MainProcess| 2024-07-21 21:05:08,974,974 multiprocessing INFO [Test epoch=0065]  nevals=32500 	| train_loss=6856.47559 	| eqs_invalid %=2.40 	| r_best=0.84698 	| quantile=0.50396 	| r_quantile_mean=0.52901 	| r_raw_sum=105.69442 	|  r_raw_mean=0.21659 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26935
MainProcess| 2024-07-21 21:05:09,255,255 multiprocessing INFO [Test epoch=0066]  nevals=33000 	| train_loss=7321.57666 	| eqs_invalid %=2.60 	| r_best=0.84698 	| quantile=0.52508 	| r_quantile_mean=0.56756 	| r_raw_sum=102.50620 	|  r_raw_mean=0.21049 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.28147
MainProcess| 2024-07-21 21:05:09,511,511 multiprocessing INFO [Test epoch=0067]  nevals=33500 	| train_loss=6896.86572 	| eqs_invalid %=2.20 	| r_best=0.84698 	| quantile=0.51152 	| r_quantile_mean=0.55261 	| r_raw_sum=107.67873 	|  r_raw_mean=0.22020 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25564
MainProcess| 2024-07-21 21:05:09,780,780 multiprocessing INFO [Test epoch=0068]  nevals=34000 	| train_loss=6854.03613 	| eqs_invalid %=3.40 	| r_best=0.84698 	| quantile=0.56285 	| r_quantile_mean=0.59571 	| r_raw_sum=104.89966 	|  r_raw_mean=0.21718 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26916
MainProcess| 2024-07-21 21:05:10,073,73 multiprocessing INFO [Test epoch=0069]  nevals=34500 	| train_loss=7498.42090 	| eqs_invalid %=2.00 	| r_best=0.84698 	| quantile=0.48416 	| r_quantile_mean=0.55162 	| r_raw_sum=102.54309 	|  r_raw_mean=0.20927 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.29212
MainProcess| 2024-07-21 21:05:10,365,365 multiprocessing INFO [Test epoch=0070]  nevals=35000 	| train_loss=7043.19141 	| eqs_invalid %=1.00 	| r_best=0.84698 	| quantile=0.50327 	| r_quantile_mean=0.55116 	| r_raw_sum=103.20504 	|  r_raw_mean=0.20850 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.29259
MainProcess| 2024-07-21 21:05:10,366,366 multiprocessing INFO [00:00:00:20.57] Training epoch 70/4000, current best R: 0.8470
MainProcess| 2024-07-21 21:05:10,648,648 multiprocessing INFO [Test epoch=0071]  nevals=35500 	| train_loss=7316.62598 	| eqs_invalid %=3.00 	| r_best=0.84698 	| quantile=0.50284 	| r_quantile_mean=0.54416 	| r_raw_sum=105.21230 	|  r_raw_mean=0.21693 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.28194
MainProcess| 2024-07-21 21:05:10,907,907 multiprocessing INFO [Test epoch=0072]  nevals=36000 	| train_loss=7068.14307 	| eqs_invalid %=1.20 	| r_best=0.84698 	| quantile=0.52519 	| r_quantile_mean=0.59081 	| r_raw_sum=108.11602 	|  r_raw_mean=0.21886 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.25930
MainProcess| 2024-07-21 21:05:11,172,172 multiprocessing INFO [Test epoch=0073]  nevals=36500 	| train_loss=7117.45850 	| eqs_invalid %=2.00 	| r_best=0.84698 	| quantile=0.54911 	| r_quantile_mean=0.58381 	| r_raw_sum=108.99299 	|  r_raw_mean=0.22243 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.26449
MainProcess| 2024-07-21 21:05:11,409,409 multiprocessing INFO [Test epoch=0074]  nevals=37000 	| train_loss=7575.74121 	| eqs_invalid %=2.40 	| r_best=0.84698 	| quantile=0.52571 	| r_quantile_mean=0.59450 	| r_raw_sum=107.36114 	|  r_raw_mean=0.22000 	| r2=0.99168 	| acc_iid=0.86567 	| acc_ood=0.17910 	| nmse_test=0.018062453357183282 	| true_equation_set_count=0 	| s/it=0.23713
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO [Test epoch=0075]  nevals=37500 	| train_loss=7123.03857 	| eqs_invalid %=1.40 	| r_best=0.86723 	| quantile=0.51681 	| r_quantile_mean=0.61124 	| r_raw_sum=104.62781 	|  r_raw_mean=0.21223 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25553
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO [00:00:00:21.87] Training epoch 75/4000, current best R: 0.8672
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Reward: 0.8672264493804485
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Traversal: add,sub,x1,mul,sub,add,sub,sin,sub,div,mul,x1,div,add,x2,x1,x1,x1,x2,x2,x1,x1,x2,x1
MainProcess| 2024-07-21 21:05:11,665,665 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:05:11,673,673 multiprocessing INFO 
	            ⎛         ⎛     x₁ + x₂⎞⎞
	  2⋅x₁ - x₂⋅⎜-x₂ - sin⎜x₂ - ───────⎟⎟
	            ⎝         ⎝        x₁  ⎠⎠

MainProcess| 2024-07-21 21:05:11,937,937 multiprocessing INFO [Test epoch=0076]  nevals=38000 	| train_loss=6627.48584 	| eqs_invalid %=3.80 	| r_best=0.86723 	| quantile=0.50687 	| r_quantile_mean=0.54025 	| r_raw_sum=103.79212 	|  r_raw_mean=0.21578 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26397
MainProcess| 2024-07-21 21:05:12,173,173 multiprocessing INFO [Test epoch=0077]  nevals=38500 	| train_loss=6758.71973 	| eqs_invalid %=1.00 	| r_best=0.86723 	| quantile=0.50059 	| r_quantile_mean=0.54096 	| r_raw_sum=106.03279 	|  r_raw_mean=0.21421 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.23575
MainProcess| 2024-07-21 21:05:12,416,416 multiprocessing INFO [Test epoch=0078]  nevals=39000 	| train_loss=6743.20654 	| eqs_invalid %=2.20 	| r_best=0.86723 	| quantile=0.54163 	| r_quantile_mean=0.58085 	| r_raw_sum=107.43800 	|  r_raw_mean=0.21971 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24250
MainProcess| 2024-07-21 21:05:12,685,685 multiprocessing INFO [Test epoch=0079]  nevals=39500 	| train_loss=6980.16455 	| eqs_invalid %=1.80 	| r_best=0.86723 	| quantile=0.46411 	| r_quantile_mean=0.52529 	| r_raw_sum=104.99111 	|  r_raw_mean=0.21383 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26929
MainProcess| 2024-07-21 21:05:12,944,944 multiprocessing INFO [Test epoch=0080]  nevals=40000 	| train_loss=6690.06543 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.54680 	| r_quantile_mean=0.58994 	| r_raw_sum=110.75246 	|  r_raw_mean=0.22603 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25865
MainProcess| 2024-07-21 21:05:12,944,944 multiprocessing INFO [00:00:00:23.15] Training epoch 80/4000, current best R: 0.8672
MainProcess| 2024-07-21 21:05:13,212,212 multiprocessing INFO [Test epoch=0081]  nevals=40500 	| train_loss=6654.51221 	| eqs_invalid %=2.20 	| r_best=0.86723 	| quantile=0.49249 	| r_quantile_mean=0.55962 	| r_raw_sum=106.20122 	|  r_raw_mean=0.21718 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26781
MainProcess| 2024-07-21 21:05:13,453,453 multiprocessing INFO [Test epoch=0082]  nevals=41000 	| train_loss=6791.67822 	| eqs_invalid %=1.60 	| r_best=0.86723 	| quantile=0.55524 	| r_quantile_mean=0.61977 	| r_raw_sum=111.57950 	|  r_raw_mean=0.22679 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24065
MainProcess| 2024-07-21 21:05:13,702,702 multiprocessing INFO [Test epoch=0083]  nevals=41500 	| train_loss=6593.22412 	| eqs_invalid %=2.40 	| r_best=0.86723 	| quantile=0.52989 	| r_quantile_mean=0.57235 	| r_raw_sum=108.62964 	|  r_raw_mean=0.22260 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24943
MainProcess| 2024-07-21 21:05:13,969,969 multiprocessing INFO [Test epoch=0084]  nevals=42000 	| train_loss=6569.37842 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.55789 	| r_quantile_mean=0.58631 	| r_raw_sum=110.93349 	|  r_raw_mean=0.22639 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26659
MainProcess| 2024-07-21 21:05:14,222,222 multiprocessing INFO [Test epoch=0085]  nevals=42500 	| train_loss=6997.22656 	| eqs_invalid %=2.80 	| r_best=0.86723 	| quantile=0.55040 	| r_quantile_mean=0.60676 	| r_raw_sum=106.97441 	|  r_raw_mean=0.22011 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25287
MainProcess| 2024-07-21 21:05:14,482,482 multiprocessing INFO [Test epoch=0086]  nevals=43000 	| train_loss=6511.38525 	| eqs_invalid %=4.20 	| r_best=0.86723 	| quantile=0.53591 	| r_quantile_mean=0.62117 	| r_raw_sum=101.47967 	|  r_raw_mean=0.21186 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26048
MainProcess| 2024-07-21 21:05:14,731,731 multiprocessing INFO [Test epoch=0087]  nevals=43500 	| train_loss=6643.14502 	| eqs_invalid %=2.20 	| r_best=0.86723 	| quantile=0.50285 	| r_quantile_mean=0.55441 	| r_raw_sum=104.13469 	|  r_raw_mean=0.21295 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24792
MainProcess| 2024-07-21 21:05:14,960,960 multiprocessing INFO [Test epoch=0088]  nevals=44000 	| train_loss=7461.03516 	| eqs_invalid %=3.00 	| r_best=0.86723 	| quantile=0.54032 	| r_quantile_mean=0.60739 	| r_raw_sum=106.40528 	|  r_raw_mean=0.21939 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.22930
MainProcess| 2024-07-21 21:05:15,204,204 multiprocessing INFO [Test epoch=0089]  nevals=44500 	| train_loss=7094.22900 	| eqs_invalid %=3.80 	| r_best=0.86723 	| quantile=0.54831 	| r_quantile_mean=0.59495 	| r_raw_sum=105.48368 	|  r_raw_mean=0.21930 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24345
MainProcess| 2024-07-21 21:05:15,457,457 multiprocessing INFO [Test epoch=0090]  nevals=45000 	| train_loss=7085.65186 	| eqs_invalid %=1.80 	| r_best=0.86723 	| quantile=0.51112 	| r_quantile_mean=0.54906 	| r_raw_sum=107.80113 	|  r_raw_mean=0.21955 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25338
MainProcess| 2024-07-21 21:05:15,457,457 multiprocessing INFO [00:00:00:25.66] Training epoch 90/4000, current best R: 0.8672
MainProcess| 2024-07-21 21:05:15,723,723 multiprocessing INFO [Test epoch=0091]  nevals=45500 	| train_loss=6917.88135 	| eqs_invalid %=3.20 	| r_best=0.86723 	| quantile=0.52181 	| r_quantile_mean=0.58948 	| r_raw_sum=102.46909 	|  r_raw_mean=0.21171 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26562
MainProcess| 2024-07-21 21:05:15,999,999 multiprocessing INFO [Test epoch=0092]  nevals=46000 	| train_loss=7465.06299 	| eqs_invalid %=1.40 	| r_best=0.86723 	| quantile=0.50837 	| r_quantile_mean=0.54525 	| r_raw_sum=106.58978 	|  r_raw_mean=0.21621 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.27615
MainProcess| 2024-07-21 21:05:16,269,269 multiprocessing INFO [Test epoch=0093]  nevals=46500 	| train_loss=7045.63477 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.57104 	| r_quantile_mean=0.59709 	| r_raw_sum=108.98077 	|  r_raw_mean=0.22241 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26988
MainProcess| 2024-07-21 21:05:16,530,530 multiprocessing INFO [Test epoch=0094]  nevals=47000 	| train_loss=6724.29834 	| eqs_invalid %=1.80 	| r_best=0.86723 	| quantile=0.52947 	| r_quantile_mean=0.56000 	| r_raw_sum=109.24051 	|  r_raw_mean=0.22249 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26061
MainProcess| 2024-07-21 21:05:16,797,797 multiprocessing INFO [Test epoch=0095]  nevals=47500 	| train_loss=6422.96094 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.56060 	| r_quantile_mean=0.61098 	| r_raw_sum=105.02825 	|  r_raw_mean=0.21434 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26722
MainProcess| 2024-07-21 21:05:17,067,67 multiprocessing INFO [Test epoch=0096]  nevals=48000 	| train_loss=6893.60254 	| eqs_invalid %=2.40 	| r_best=0.86723 	| quantile=0.54163 	| r_quantile_mean=0.58272 	| r_raw_sum=107.65250 	|  r_raw_mean=0.22060 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26902
MainProcess| 2024-07-21 21:05:17,333,333 multiprocessing INFO [Test epoch=0097]  nevals=48500 	| train_loss=6997.91260 	| eqs_invalid %=1.40 	| r_best=0.86723 	| quantile=0.55449 	| r_quantile_mean=0.58829 	| r_raw_sum=105.22155 	|  r_raw_mean=0.21343 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26665
MainProcess| 2024-07-21 21:05:17,590,590 multiprocessing INFO [Test epoch=0098]  nevals=49000 	| train_loss=6877.39355 	| eqs_invalid %=2.20 	| r_best=0.86723 	| quantile=0.52835 	| r_quantile_mean=0.56956 	| r_raw_sum=110.43308 	|  r_raw_mean=0.22583 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25670
MainProcess| 2024-07-21 21:05:17,857,857 multiprocessing INFO [Test epoch=0099]  nevals=49500 	| train_loss=7440.77441 	| eqs_invalid %=1.40 	| r_best=0.86723 	| quantile=0.57257 	| r_quantile_mean=0.64107 	| r_raw_sum=112.78944 	|  r_raw_mean=0.22878 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26650
MainProcess| 2024-07-21 21:05:18,126,126 multiprocessing INFO [Test epoch=0100]  nevals=50000 	| train_loss=6959.36670 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.54197 	| r_quantile_mean=0.62609 	| r_raw_sum=106.78932 	|  r_raw_mean=0.21794 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26891
MainProcess| 2024-07-21 21:05:18,126,126 multiprocessing INFO [00:00:00:28.33] Training epoch 100/4000, current best R: 0.8672
MainProcess| 2024-07-21 21:05:18,380,380 multiprocessing INFO [Test epoch=0101]  nevals=50500 	| train_loss=6726.41943 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.50159 	| r_quantile_mean=0.56155 	| r_raw_sum=104.47538 	|  r_raw_mean=0.21322 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25383
MainProcess| 2024-07-21 21:05:18,629,629 multiprocessing INFO [Test epoch=0102]  nevals=51000 	| train_loss=6915.68994 	| eqs_invalid %=1.60 	| r_best=0.86723 	| quantile=0.55006 	| r_quantile_mean=0.59967 	| r_raw_sum=112.13901 	|  r_raw_mean=0.22792 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24890
MainProcess| 2024-07-21 21:05:18,865,865 multiprocessing INFO [Test epoch=0103]  nevals=51500 	| train_loss=7392.38135 	| eqs_invalid %=1.00 	| r_best=0.86723 	| quantile=0.54520 	| r_quantile_mean=0.60027 	| r_raw_sum=111.60405 	|  r_raw_mean=0.22546 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.23554
MainProcess| 2024-07-21 21:05:19,120,120 multiprocessing INFO [Test epoch=0104]  nevals=52000 	| train_loss=6321.69824 	| eqs_invalid %=1.00 	| r_best=0.86723 	| quantile=0.53678 	| r_quantile_mean=0.59077 	| r_raw_sum=108.08079 	|  r_raw_mean=0.21835 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25499
MainProcess| 2024-07-21 21:05:19,371,371 multiprocessing INFO [Test epoch=0105]  nevals=52500 	| train_loss=6989.24072 	| eqs_invalid %=1.80 	| r_best=0.86723 	| quantile=0.54933 	| r_quantile_mean=0.61997 	| r_raw_sum=108.88334 	|  r_raw_mean=0.22176 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25137
MainProcess| 2024-07-21 21:05:19,618,618 multiprocessing INFO [Test epoch=0106]  nevals=53000 	| train_loss=6232.53516 	| eqs_invalid %=2.20 	| r_best=0.86723 	| quantile=0.57185 	| r_quantile_mean=0.64856 	| r_raw_sum=115.43655 	|  r_raw_mean=0.23607 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24656
MainProcess| 2024-07-21 21:05:19,886,886 multiprocessing INFO [Test epoch=0107]  nevals=53500 	| train_loss=7500.40820 	| eqs_invalid %=1.60 	| r_best=0.86723 	| quantile=0.56691 	| r_quantile_mean=0.62405 	| r_raw_sum=114.38809 	|  r_raw_mean=0.23250 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26818
MainProcess| 2024-07-21 21:05:20,123,123 multiprocessing INFO [Test epoch=0108]  nevals=54000 	| train_loss=6219.25781 	| eqs_invalid %=0.60 	| r_best=0.86723 	| quantile=0.53242 	| r_quantile_mean=0.56763 	| r_raw_sum=111.60229 	|  r_raw_mean=0.22455 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.23642
MainProcess| 2024-07-21 21:05:20,364,364 multiprocessing INFO [Test epoch=0109]  nevals=54500 	| train_loss=7076.19385 	| eqs_invalid %=1.20 	| r_best=0.86723 	| quantile=0.61321 	| r_quantile_mean=0.66656 	| r_raw_sum=113.43968 	|  r_raw_mean=0.22963 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24123
MainProcess| 2024-07-21 21:05:20,799,799 multiprocessing INFO [Test epoch=0110]  nevals=55000 	| train_loss=6186.87793 	| eqs_invalid %=1.00 	| r_best=0.86723 	| quantile=0.57149 	| r_quantile_mean=0.60877 	| r_raw_sum=112.04253 	|  r_raw_mean=0.22635 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.43435
MainProcess| 2024-07-21 21:05:20,799,799 multiprocessing INFO [00:00:00:31.01] Training epoch 110/4000, current best R: 0.8672
MainProcess| 2024-07-21 21:05:21,108,108 multiprocessing INFO [Test epoch=0111]  nevals=55500 	| train_loss=6981.71338 	| eqs_invalid %=1.40 	| r_best=0.86723 	| quantile=0.57145 	| r_quantile_mean=0.61947 	| r_raw_sum=115.93356 	|  r_raw_mean=0.23516 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.30841
MainProcess| 2024-07-21 21:05:21,398,398 multiprocessing INFO [Test epoch=0112]  nevals=56000 	| train_loss=7498.41455 	| eqs_invalid %=2.60 	| r_best=0.86723 	| quantile=0.58595 	| r_quantile_mean=0.64244 	| r_raw_sum=113.84627 	|  r_raw_mean=0.23377 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.28979
MainProcess| 2024-07-21 21:05:21,649,649 multiprocessing INFO [Test epoch=0113]  nevals=56500 	| train_loss=6965.03174 	| eqs_invalid %=1.00 	| r_best=0.86723 	| quantile=0.58395 	| r_quantile_mean=0.62087 	| r_raw_sum=115.96683 	|  r_raw_mean=0.23428 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25091
MainProcess| 2024-07-21 21:05:21,913,913 multiprocessing INFO [Test epoch=0114]  nevals=57000 	| train_loss=7005.65430 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.60921 	| r_quantile_mean=0.64822 	| r_raw_sum=118.66359 	|  r_raw_mean=0.24217 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26477
MainProcess| 2024-07-21 21:05:22,164,164 multiprocessing INFO [Test epoch=0115]  nevals=57500 	| train_loss=6939.23047 	| eqs_invalid %=1.20 	| r_best=0.86723 	| quantile=0.49697 	| r_quantile_mean=0.53084 	| r_raw_sum=110.32304 	|  r_raw_mean=0.22333 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.25039
MainProcess| 2024-07-21 21:05:22,406,406 multiprocessing INFO [Test epoch=0116]  nevals=58000 	| train_loss=6184.18604 	| eqs_invalid %=2.00 	| r_best=0.86723 	| quantile=0.54746 	| r_quantile_mean=0.58153 	| r_raw_sum=113.32548 	|  r_raw_mean=0.23128 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.24207
MainProcess| 2024-07-21 21:05:22,672,672 multiprocessing INFO [Test epoch=0117]  nevals=58500 	| train_loss=6166.98828 	| eqs_invalid %=1.00 	| r_best=0.86723 	| quantile=0.63439 	| r_quantile_mean=0.66312 	| r_raw_sum=121.89931 	|  r_raw_mean=0.24626 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.26542
MainProcess| 2024-07-21 21:05:22,907,907 multiprocessing INFO [Test epoch=0118]  nevals=59000 	| train_loss=6900.30176 	| eqs_invalid %=1.20 	| r_best=0.86723 	| quantile=0.54523 	| r_quantile_mean=0.59417 	| r_raw_sum=112.72721 	|  r_raw_mean=0.22819 	| r2=0.99368 	| acc_iid=0.88060 	| acc_ood=0.32836 	| nmse_test=0.0151105202240068 	| true_equation_set_count=0 	| s/it=0.23522
MainProcess| 2024-07-21 21:05:22,922,922 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:05:27,211,211 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:05:27,212,212 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:05:27,212,212 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:05:27,213,213 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:05:27,321,321 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:05:27,323,323 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:05:27,376,376 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:05:27,380,380 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:05:28,368,368 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:05:28,373,373 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-210527', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-210527_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98535 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.43115 	| r_quantile_mean=0.47069 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=2.95839
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO [00:00:00:02.96] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:05:31,339,339 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:05:31,476,476 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:05:31,696,696 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.01904 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.45167 	| r_quantile_mean=0.47763 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.22050
MainProcess| 2024-07-21 21:05:31,696,696 multiprocessing INFO [00:00:00:03.32] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:05:31,697,697 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:05:31,703,703 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-21 21:05:31,934,934 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.15771 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.43941 	| r_quantile_mean=0.47530 	| r_raw_sum=129.25411 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.23069
MainProcess| 2024-07-21 21:05:31,934,934 multiprocessing INFO [00:00:00:03.55] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-21 21:05:31,934,934 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:05:31,934,934 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-21 21:05:31,934,934 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:05:31,935,935 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:05:31,935,935 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:05:31,935,935 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:05:31,935,935 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-21 21:05:31,935,935 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:05:31,937,937 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-21 21:05:32,198,198 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.23291 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.42888 	| r_quantile_mean=0.46270 	| r_raw_sum=117.54209 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.26045
MainProcess| 2024-07-21 21:05:32,423,423 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.14746 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.44101 	| r_quantile_mean=0.46739 	| r_raw_sum=128.03525 	|  r_raw_mean=0.26237 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.22531
MainProcess| 2024-07-21 21:05:32,659,659 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.34082 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.43613 	| r_quantile_mean=0.49204 	| r_raw_sum=120.16180 	|  r_raw_mean=0.24878 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23612
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO [00:00:00:04.28] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:05:32,660,660 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:05:32,667,667 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:05:32,900,900 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.09619 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.44707 	| r_quantile_mean=0.46046 	| r_raw_sum=127.93508 	|  r_raw_mean=0.26216 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23305
MainProcess| 2024-07-21 21:05:33,238,238 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.00195 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.44718 	| r_quantile_mean=0.47075 	| r_raw_sum=128.22742 	|  r_raw_mean=0.26330 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.33822
MainProcess| 2024-07-21 21:05:33,464,464 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.71143 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.42333 	| r_quantile_mean=0.46076 	| r_raw_sum=129.50745 	|  r_raw_mean=0.26758 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22570
MainProcess| 2024-07-21 21:05:33,694,694 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7156.14355 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.42737 	| r_quantile_mean=0.47230 	| r_raw_sum=121.74037 	|  r_raw_mean=0.24998 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22968
MainProcess| 2024-07-21 21:05:33,694,694 multiprocessing INFO [00:00:00:05.31] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:05:33,922,922 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5832.70996 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45000 	| r_quantile_mean=0.46353 	| r_raw_sum=124.90093 	|  r_raw_mean=0.25700 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22794
MainProcess| 2024-07-21 21:05:34,146,146 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.83496 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.43472 	| r_quantile_mean=0.45875 	| r_raw_sum=126.19979 	|  r_raw_mean=0.25755 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22348
MainProcess| 2024-07-21 21:05:34,374,374 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6806.99902 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.42042 	| r_quantile_mean=0.44956 	| r_raw_sum=116.02136 	|  r_raw_mean=0.23922 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22813
MainProcess| 2024-07-21 21:05:34,596,596 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.37134 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.45187 	| r_quantile_mean=0.48277 	| r_raw_sum=124.27290 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22224
MainProcess| 2024-07-21 21:05:34,828,828 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6365.89160 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.43130 	| r_quantile_mean=0.48372 	| r_raw_sum=121.59467 	|  r_raw_mean=0.25280 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23125
MainProcess| 2024-07-21 21:05:35,050,50 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6353.21582 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.44386 	| r_quantile_mean=0.47995 	| r_raw_sum=129.72593 	|  r_raw_mean=0.26475 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22235
MainProcess| 2024-07-21 21:05:35,285,285 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=6885.88818 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.45379 	| r_quantile_mean=0.47478 	| r_raw_sum=122.35507 	|  r_raw_mean=0.25124 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23428
MainProcess| 2024-07-21 21:05:35,518,518 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7470.51855 	| eqs_invalid %=1.60 	| r_best=0.72143 	| quantile=0.44833 	| r_quantile_mean=0.47002 	| r_raw_sum=121.44528 	|  r_raw_mean=0.24684 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23331
MainProcess| 2024-07-21 21:05:35,742,742 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=7492.91357 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.42282 	| r_quantile_mean=0.44916 	| r_raw_sum=121.02499 	|  r_raw_mean=0.24902 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22407
MainProcess| 2024-07-21 21:05:35,973,973 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=7474.62891 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.42919 	| r_quantile_mean=0.44989 	| r_raw_sum=121.86920 	|  r_raw_mean=0.24821 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23044
MainProcess| 2024-07-21 21:05:35,973,973 multiprocessing INFO [00:00:00:07.59] Training epoch 20/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:05:36,217,217 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=6241.87891 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.44262 	| r_quantile_mean=0.49960 	| r_raw_sum=120.16841 	|  r_raw_mean=0.25035 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.24407
MainProcess| 2024-07-21 21:05:36,440,440 multiprocessing INFO [Test epoch=0022]  nevals=11000 	| train_loss=6755.65186 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.44875 	| r_quantile_mean=0.47400 	| r_raw_sum=120.54319 	|  r_raw_mean=0.24803 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22242
MainProcess| 2024-07-21 21:05:36,680,680 multiprocessing INFO [Test epoch=0023]  nevals=11500 	| train_loss=7082.71143 	| eqs_invalid %=1.20 	| r_best=0.72143 	| quantile=0.43303 	| r_quantile_mean=0.47955 	| r_raw_sum=126.72220 	|  r_raw_mean=0.25652 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23951
MainProcess| 2024-07-21 21:05:36,908,908 multiprocessing INFO [Test epoch=0024]  nevals=12000 	| train_loss=6260.67822 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.44320 	| r_quantile_mean=0.46730 	| r_raw_sum=133.87194 	|  r_raw_mean=0.27321 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22853
MainProcess| 2024-07-21 21:05:37,165,165 multiprocessing INFO [Test epoch=0025]  nevals=12500 	| train_loss=6172.07031 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.42806 	| r_quantile_mean=0.45675 	| r_raw_sum=119.94023 	|  r_raw_mean=0.24832 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.25628
MainProcess| 2024-07-21 21:05:37,391,391 multiprocessing INFO [Test epoch=0026]  nevals=13000 	| train_loss=6245.58594 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.44626 	| r_quantile_mean=0.47274 	| r_raw_sum=125.85144 	|  r_raw_mean=0.25949 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22631
MainProcess| 2024-07-21 21:05:37,409,409 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:05:56,189,189 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:05:56,190,190 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:05:56,190,190 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:05:56,191,191 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:05:56,299,299 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:05:56,300,300 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:05:56,353,353 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:05:56,357,357 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:05:57,336,336 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:05:57,343,343 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:05:57,348,348 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-210556', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-210556_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6537.44189 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=1.00000 	| r_quantile_mean=1.00000 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.66978
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO [00:00:00:05.67] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-21 21:06:03,026,26 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:06:03,051,51 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:06:03,051,51 multiprocessing INFO [00:00:00:05.70] Early stopping criteria met; breaking early.
MainProcess| 2024-07-21 21:06:03,051,51 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-21 21:06:03,051,51 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-21 21:06:03,230,230 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:06:03,231,231 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:06:03,231,231 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-21 21:06:03,232,232 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-21 21:06:03,232,232 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-21 21:06:03,232,232 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-21 21:06:03,402,402 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-21-210556_0/summary.csv'
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-21-210556_0
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO Found issues:
MainProcess| 2024-07-21 21:06:03,537,537 multiprocessing INFO   0
MainProcess| 2024-07-21 21:06:03,538,538 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-21 21:06:03,538,538 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:06:03,538,538 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:06:03,538,538 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:06:03,539,539 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:06:03,539,539 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:06:03,539,539 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-21 21:06:03,539,539 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.876364707946777, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.876364707946777, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO Fin.
MainProcess| 2024-07-21 21:06:03,540,540 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:09:23,261,261 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:09:23,261,261 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:09:23,261,261 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:09:23,263,263 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:09:23,371,371 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:09:23,372,372 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:09:23,426,426 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:09:23,430,430 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:09:24,272,272 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:09:24,281,281 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:09:24,287,287 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:09:54,731,731 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:09:54,731,731 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:09:54,731,731 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:09:54,732,732 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:09:54,841,841 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:09:54,842,842 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:09:54,899,899 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:09:54,903,903 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:09:55,847,847 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:09:55,854,854 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:09:55,860,860 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-210954', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-210954_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:10:01,614,614 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:11:39,893,893 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:11:39,893,893 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:11:39,894,894 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:11:39,895,895 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:11:40,002,2 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:11:40,003,3 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=False gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:11:40,056,56 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:11:40,060,60 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:11:40,911,911 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:11:40,914,914 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:11:40,918,918 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-211140', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-211140_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': False, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:11:46,305,305 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:18:38,684,684 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:18:38,684,684 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:18:38,685,685 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:18:38,686,686 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:18:38,795,795 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:18:38,796,796 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:18:38,850,850 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:18:38,853,853 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:18:39,712,712 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:18:39,722,722 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:18:39,727,727 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-211838', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-211838_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': 0.1, 'baseline': 'R_e', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:18:45,121,121 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:19:21,920,920 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:19:21,921,921 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:19:21,921,921 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:19:21,922,922 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:19:22,031,31 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:19:22,032,32 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:19:22,085,85 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:19:22,089,89 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:19:23,100,100 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:19:23,107,107 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:19:23,112,112 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-211922', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-211922_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': 0.1, 'baseline': 'R_e', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6537.44189 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=1.00000 	| r_quantile_mean=1.00000 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.65272
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO [00:00:00:05.65] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-21 21:19:28,775,775 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:19:28,800,800 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:19:28,800,800 multiprocessing INFO [00:00:00:05.68] Early stopping criteria met; breaking early.
MainProcess| 2024-07-21 21:19:28,800,800 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-21 21:19:28,800,800 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-21 21:19:28,981,981 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:19:28,982,982 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:19:28,982,982 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-21 21:19:28,983,983 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-21 21:19:28,983,983 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-21 21:19:28,983,983 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-21 21:19:29,175,175 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-21-211922_0/summary.csv'
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-21-211922_0
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO Found issues:
MainProcess| 2024-07-21 21:19:29,317,317 multiprocessing INFO   0
MainProcess| 2024-07-21 21:19:29,318,318 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-21 21:19:29,318,318 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:19:29,318,318 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:19:29,318,318 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:19:29,319,319 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:19:29,319,319 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:19:29,319,319 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-21 21:19:29,319,319 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:19:29,320,320 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-21 21:19:29,320,320 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-21 21:19:29,320,320 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-21 21:19:29,320,320 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.861133098602295, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:19:29,320,320 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.861133098602295, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:19:29,320,320 multiprocessing INFO Fin.
MainProcess| 2024-07-21 21:19:29,321,321 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:39:06,508,508 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:39:06,508,508 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:39:06,508,508 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:39:06,510,510 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:39:06,618,618 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:39:06,619,619 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:39:06,674,674 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:39:06,678,678 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:39:07,520,520 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:39:07,526,526 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-213906', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-213906_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:39:10,704,704 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.99316 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.37652 	| r_quantile_mean=0.41110 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=3.17104
MainProcess| 2024-07-21 21:39:10,704,704 multiprocessing INFO [00:00:00:03.17] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-21 21:39:10,704,704 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:39:10,704,704 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:39:10,704,704 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:39:10,704,704 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:39:10,705,705 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:39:10,705,705 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:39:10,705,705 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:39:10,705,705 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:39:10,841,841 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:39:11,369,369 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02539 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.37784 	| r_quantile_mean=0.41459 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.52789
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO [00:00:00:03.84] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:39:11,370,370 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:39:11,377,377 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.34668 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.37785 	| r_quantile_mean=0.41106 	| r_raw_sum=129.25192 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.40988
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO [00:00:00:04.25] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-21 21:39:11,787,787 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:39:11,789,789 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-21 21:39:12,187,187 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5791.71436 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.37373 	| r_quantile_mean=0.40418 	| r_raw_sum=117.54209 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.39777
MainProcess| 2024-07-21 21:39:12,584,584 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.30713 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.37577 	| r_quantile_mean=0.40701 	| r_raw_sum=127.90967 	|  r_raw_mean=0.26211 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.39679
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.48633 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.37560 	| r_quantile_mean=0.41407 	| r_raw_sum=120.17526 	|  r_raw_mean=0.24881 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.40745
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO [00:00:00:05.46] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:39:12,992,992 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:39:12,998,998 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:39:13,511,511 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.23145 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.38387 	| r_quantile_mean=0.41741 	| r_raw_sum=128.26050 	|  r_raw_mean=0.26283 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.51229
MainProcess| 2024-07-21 21:39:13,926,926 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.11719 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.37805 	| r_quantile_mean=0.41435 	| r_raw_sum=128.47349 	|  r_raw_mean=0.26381 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.41559
MainProcess| 2024-07-21 21:39:14,317,317 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.80469 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.37679 	| r_quantile_mean=0.40752 	| r_raw_sum=129.50745 	|  r_raw_mean=0.26758 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.38986
MainProcess| 2024-07-21 21:39:14,714,714 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7157.07910 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.36936 	| r_quantile_mean=0.40429 	| r_raw_sum=121.73971 	|  r_raw_mean=0.24998 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.39770
MainProcess| 2024-07-21 21:39:14,714,714 multiprocessing INFO [00:00:00:07.18] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:39:15,112,112 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5832.26025 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.38127 	| r_quantile_mean=0.41504 	| r_raw_sum=124.90093 	|  r_raw_mean=0.25700 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.39740
MainProcess| 2024-07-21 21:39:15,612,612 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.62744 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.37727 	| r_quantile_mean=0.40933 	| r_raw_sum=125.91858 	|  r_raw_mean=0.25698 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.50009
MainProcess| 2024-07-21 21:39:16,019,19 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6807.05957 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.37104 	| r_quantile_mean=0.40002 	| r_raw_sum=115.96722 	|  r_raw_mean=0.23911 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.40617
MainProcess| 2024-07-21 21:39:16,429,429 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.17432 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.37811 	| r_quantile_mean=0.41873 	| r_raw_sum=124.27257 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.41034
MainProcess| 2024-07-21 21:39:16,828,828 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6365.07031 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.37846 	| r_quantile_mean=0.41278 	| r_raw_sum=121.25522 	|  r_raw_mean=0.25209 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.39864
MainProcess| 2024-07-21 21:39:17,225,225 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6352.42334 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.38268 	| r_quantile_mean=0.41505 	| r_raw_sum=129.67755 	|  r_raw_mean=0.26465 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.39740
MainProcess| 2024-07-21 21:39:17,732,732 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=6885.76611 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.37918 	| r_quantile_mean=0.41390 	| r_raw_sum=122.36448 	|  r_raw_mean=0.25126 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.50639
MainProcess| 2024-07-21 21:39:18,132,132 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7469.75488 	| eqs_invalid %=1.60 	| r_best=0.72143 	| quantile=0.38220 	| r_quantile_mean=0.41475 	| r_raw_sum=121.44528 	|  r_raw_mean=0.24684 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.40017
MainProcess| 2024-07-21 21:39:18,543,543 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=7493.00879 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.37845 	| r_quantile_mean=0.40668 	| r_raw_sum=121.23035 	|  r_raw_mean=0.24945 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.41115
MainProcess| 2024-07-21 21:39:18,977,977 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=7474.72852 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.37838 	| r_quantile_mean=0.40661 	| r_raw_sum=121.86920 	|  r_raw_mean=0.24821 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.43284
MainProcess| 2024-07-21 21:39:18,977,977 multiprocessing INFO [00:00:00:11.44] Training epoch 20/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:39:19,528,528 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=6241.20166 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.37805 	| r_quantile_mean=0.41552 	| r_raw_sum=120.17217 	|  r_raw_mean=0.25036 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.55154
MainProcess| 2024-07-21 21:39:19,603,603 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:40:33,089,89 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:40:33,089,89 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:40:33,089,89 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:40:33,090,90 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:40:33,198,198 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:40:33,199,199 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:40:33,255,255 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:40:33,259,259 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:40:34,172,172 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:40:34,177,177 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:40:34,183,183 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-214033', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-214033_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6204.98291 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=0.48264 	| r_quantile_mean=0.95364 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.53768
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO [00:00:00:05.54] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-21 21:40:39,726,726 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-21 21:40:39,727,727 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:40:39,727,727 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-21 21:40:39,727,727 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:40:39,753,753 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:40:39,753,753 multiprocessing INFO [00:00:00:05.56] Early stopping criteria met; breaking early.
MainProcess| 2024-07-21 21:40:39,753,753 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-21 21:40:39,753,753 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:40:39,935,935 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:40:40,168,168 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:40:40,168,168 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-21 21:40:40,169,169 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-21 21:40:40,169,169 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-21 21:40:40,169,169 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-21 21:40:40,238,238 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-21-214033_0/summary.csv'
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-21-214033_0
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Found issues:
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO   0
MainProcess| 2024-07-21 21:40:40,377,377 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-21 21:40:40,378,378 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:40:40,378,378 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:40:40,378,378 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:40:40,379,379 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:40:40,379,379 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:40:40,379,379 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-21 21:40:40,379,379 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.98066520690918, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.98066520690918, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO Fin.
MainProcess| 2024-07-21 21:40:40,380,380 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:44:17,609,609 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:44:17,609,609 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:44:17,609,609 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:44:17,610,610 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:44:17,735,735 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:44:17,736,736 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:44:17,791,791 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:44:17,795,795 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:44:18,680,680 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:44:18,686,686 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:44:18,691,691 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-214417', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-214417_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:44:24,023,23 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:45:12,292,292 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:45:12,292,292 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:45:12,292,292 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:45:12,294,294 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:45:12,404,404 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:45:12,405,405 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:45:12,459,459 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:45:12,463,463 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:45:13,444,444 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:45:13,451,451 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-21 21:45:13,457,457 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-214512', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-214512_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:45:18,957,957 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:50:32,406,406 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:50:32,406,406 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:50:32,406,406 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:50:32,407,407 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:50:32,526,526 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:50:32,527,527 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:50:32,584,584 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:50:32,588,588 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:50:33,552,552 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:50:33,557,557 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-215032', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-215032_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:50:36,592,592 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:50:58,585,585 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:50:58,585,585 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:50:58,585,585 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:50:58,587,587 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:50:58,709,709 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:50:58,710,710 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:50:58,771,771 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:50:58,775,775 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:50:59,664,664 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:50:59,671,671 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-215058', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-215058_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98291 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.48264 	| r_quantile_mean=0.48999 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=3.13308
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO [00:00:00:03.13] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:02,815,815 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:02,816,816 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:02,816,816 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:51:02,816,816 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:02,960,960 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02002 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.47344 	| r_quantile_mean=0.49624 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.21737
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO [00:00:00:03.50] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:51:03,178,178 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:03,185,185 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.19336 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.46628 	| r_quantile_mean=0.49914 	| r_raw_sum=129.25510 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.23561
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO [00:00:00:03.74] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:03,421,421 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:03,422,422 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-21 21:51:03,422,422 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:03,426,426 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-21 21:51:03,678,678 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.71289 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.46473 	| r_quantile_mean=0.47559 	| r_raw_sum=117.54185 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.25192
MainProcess| 2024-07-21 21:51:03,878,878 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.17090 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.47530 	| r_quantile_mean=0.48596 	| r_raw_sum=128.26342 	|  r_raw_mean=0.26283 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.19939
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.36084 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.47117 	| r_quantile_mean=0.52967 	| r_raw_sum=120.16180 	|  r_raw_mean=0.24878 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19990
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO [00:00:00:04.40] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:51:04,078,78 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:04,085,85 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:51:04,297,297 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.10498 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.46067 	| r_quantile_mean=0.46984 	| r_raw_sum=127.93508 	|  r_raw_mean=0.26216 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21133
MainProcess| 2024-07-21 21:51:04,502,502 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.00537 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.48430 	| r_quantile_mean=0.48865 	| r_raw_sum=128.22742 	|  r_raw_mean=0.26330 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20486
MainProcess| 2024-07-21 21:51:04,702,702 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.37842 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.46033 	| r_quantile_mean=0.47904 	| r_raw_sum=129.50090 	|  r_raw_mean=0.26756 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19952
MainProcess| 2024-07-21 21:51:04,907,907 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7155.97852 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47094 	| r_quantile_mean=0.50096 	| r_raw_sum=121.65239 	|  r_raw_mean=0.24980 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20530
MainProcess| 2024-07-21 21:51:04,907,907 multiprocessing INFO [00:00:00:05.23] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:51:05,281,281 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5833.21191 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45977 	| r_quantile_mean=0.47310 	| r_raw_sum=124.93872 	|  r_raw_mean=0.25708 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.37344
MainProcess| 2024-07-21 21:51:05,515,515 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.75781 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.45748 	| r_quantile_mean=0.47683 	| r_raw_sum=126.19979 	|  r_raw_mean=0.25755 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23426
MainProcess| 2024-07-21 21:51:05,722,722 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6806.96680 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.45037 	| r_quantile_mean=0.46860 	| r_raw_sum=116.02136 	|  r_raw_mean=0.23922 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20720
MainProcess| 2024-07-21 21:51:05,931,931 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.34180 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47446 	| r_quantile_mean=0.50009 	| r_raw_sum=124.27290 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20810
MainProcess| 2024-07-21 21:51:06,146,146 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6366.23828 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.46775 	| r_quantile_mean=0.52274 	| r_raw_sum=121.59467 	|  r_raw_mean=0.25280 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21467
MainProcess| 2024-07-21 21:51:06,348,348 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6353.54395 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46312 	| r_quantile_mean=0.51069 	| r_raw_sum=129.73545 	|  r_raw_mean=0.26477 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20160
MainProcess| 2024-07-21 21:51:06,498,498 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:51:37,169,169 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:51:37,169,169 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:51:37,169,169 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:51:37,171,171 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:51:37,278,278 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:51:37,279,279 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:51:37,333,333 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:51:37,337,337 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:51:38,192,192 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:51:38,197,197 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-215137', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-215137_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98291 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.48264 	| r_quantile_mean=0.48999 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=2.98254
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO [00:00:00:02.98] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:41,186,186 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:51:41,187,187 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:41,329,329 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02002 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.47344 	| r_quantile_mean=0.49624 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.22517
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO [00:00:00:03.35] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:51:41,554,554 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:41,561,561 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-21 21:51:41,770,770 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.19336 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.46628 	| r_quantile_mean=0.49914 	| r_raw_sum=129.25510 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.20942
MainProcess| 2024-07-21 21:51:41,770,770 multiprocessing INFO [00:00:00:03.57] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-21 21:51:41,770,770 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:41,770,770 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-21 21:51:41,770,770 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:41,771,771 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:41,771,771 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:41,771,771 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:41,771,771 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-21 21:51:41,771,771 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:41,773,773 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-21 21:51:42,043,43 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.71289 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.46473 	| r_quantile_mean=0.47559 	| r_raw_sum=117.54185 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.27035
MainProcess| 2024-07-21 21:51:42,248,248 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.17090 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.47530 	| r_quantile_mean=0.48596 	| r_raw_sum=128.26342 	|  r_raw_mean=0.26283 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.20446
MainProcess| 2024-07-21 21:51:42,455,455 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.36084 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.47117 	| r_quantile_mean=0.52967 	| r_raw_sum=120.16180 	|  r_raw_mean=0.24878 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20736
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO [00:00:00:04.25] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:51:42,456,456 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:51:42,466,466 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:51:42,677,677 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.10498 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.46067 	| r_quantile_mean=0.46984 	| r_raw_sum=127.93508 	|  r_raw_mean=0.26216 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21125
MainProcess| 2024-07-21 21:51:42,883,883 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.00537 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.48430 	| r_quantile_mean=0.48865 	| r_raw_sum=128.22742 	|  r_raw_mean=0.26330 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20523
MainProcess| 2024-07-21 21:51:43,074,74 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.37842 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.46033 	| r_quantile_mean=0.47904 	| r_raw_sum=129.50090 	|  r_raw_mean=0.26756 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19114
MainProcess| 2024-07-21 21:51:43,161,161 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:53:50,440,440 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:53:50,440,440 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:53:50,441,441 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:53:50,442,442 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:53:50,550,550 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:53:50,551,551 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:53:50,604,604 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:53:50,608,608 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:53:51,440,440 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:53:51,445,445 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-215350', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-215350_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98291 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.48264 	| r_quantile_mean=0.48999 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=2.96911
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO [00:00:00:02.97] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:53:54,422,422 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:53:54,564,564 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02002 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.47344 	| r_quantile_mean=0.49624 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.19335
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO [00:00:00:03.31] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:53:54,758,758 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:53:54,765,765 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.19336 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.46628 	| r_quantile_mean=0.49914 	| r_raw_sum=129.25510 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.20825
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO [00:00:00:03.52] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-21 21:53:54,973,973 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:53:54,975,975 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-21 21:53:55,212,212 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.71289 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.46473 	| r_quantile_mean=0.47559 	| r_raw_sum=117.54185 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.23607
MainProcess| 2024-07-21 21:53:55,407,407 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.17090 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.47530 	| r_quantile_mean=0.48596 	| r_raw_sum=128.26342 	|  r_raw_mean=0.26283 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.19547
MainProcess| 2024-07-21 21:53:55,621,621 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.36084 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.47117 	| r_quantile_mean=0.52967 	| r_raw_sum=120.16180 	|  r_raw_mean=0.24878 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21398
MainProcess| 2024-07-21 21:53:55,621,621 multiprocessing INFO [00:00:00:04.17] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:53:55,621,621 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:53:55,621,621 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:53:55,621,621 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:53:55,621,621 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:53:55,622,622 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:53:55,622,622 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:53:55,622,622 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:53:55,622,622 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:53:55,627,627 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:53:55,817,817 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.10498 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.46067 	| r_quantile_mean=0.46984 	| r_raw_sum=127.93508 	|  r_raw_mean=0.26216 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18913
MainProcess| 2024-07-21 21:53:56,021,21 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.00537 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.48430 	| r_quantile_mean=0.48865 	| r_raw_sum=128.22742 	|  r_raw_mean=0.26330 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20426
MainProcess| 2024-07-21 21:53:56,229,229 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.37842 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.46033 	| r_quantile_mean=0.47904 	| r_raw_sum=129.50090 	|  r_raw_mean=0.26756 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20819
MainProcess| 2024-07-21 21:53:56,431,431 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7155.97852 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47094 	| r_quantile_mean=0.50096 	| r_raw_sum=121.65239 	|  r_raw_mean=0.24980 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20124
MainProcess| 2024-07-21 21:53:56,431,431 multiprocessing INFO [00:00:00:04.98] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:53:56,738,738 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5833.21191 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45977 	| r_quantile_mean=0.47310 	| r_raw_sum=124.93872 	|  r_raw_mean=0.25708 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30743
MainProcess| 2024-07-21 21:53:56,940,940 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.75781 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.45748 	| r_quantile_mean=0.47683 	| r_raw_sum=126.19979 	|  r_raw_mean=0.25755 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20129
MainProcess| 2024-07-21 21:53:57,134,134 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6806.96680 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.45037 	| r_quantile_mean=0.46860 	| r_raw_sum=116.02136 	|  r_raw_mean=0.23922 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19415
MainProcess| 2024-07-21 21:53:57,341,341 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.34180 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47446 	| r_quantile_mean=0.50009 	| r_raw_sum=124.27290 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20619
MainProcess| 2024-07-21 21:53:57,540,540 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6366.23828 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.46775 	| r_quantile_mean=0.52274 	| r_raw_sum=121.59467 	|  r_raw_mean=0.25280 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19942
MainProcess| 2024-07-21 21:53:57,744,744 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6353.54395 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46312 	| r_quantile_mean=0.51069 	| r_raw_sum=129.73545 	|  r_raw_mean=0.26477 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20378
MainProcess| 2024-07-21 21:53:57,946,946 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=6886.15430 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47073 	| r_quantile_mean=0.48576 	| r_raw_sum=122.36201 	|  r_raw_mean=0.25126 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20204
MainProcess| 2024-07-21 21:53:58,164,164 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7471.12695 	| eqs_invalid %=1.40 	| r_best=0.72143 	| quantile=0.47487 	| r_quantile_mean=0.48683 	| r_raw_sum=121.78742 	|  r_raw_mean=0.24703 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21795
MainProcess| 2024-07-21 21:53:58,371,371 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=7493.12402 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.43365 	| r_quantile_mean=0.47038 	| r_raw_sum=121.43672 	|  r_raw_mean=0.24987 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20682
MainProcess| 2024-07-21 21:53:58,567,567 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=7474.82080 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.43368 	| r_quantile_mean=0.46999 	| r_raw_sum=121.92947 	|  r_raw_mean=0.24833 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19577
MainProcess| 2024-07-21 21:53:58,567,567 multiprocessing INFO [00:00:00:07.11] Training epoch 20/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:53:58,759,759 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=6242.10059 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.46892 	| r_quantile_mean=0.54189 	| r_raw_sum=120.16841 	|  r_raw_mean=0.25035 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19113
MainProcess| 2024-07-21 21:53:58,966,966 multiprocessing INFO [Test epoch=0022]  nevals=11000 	| train_loss=6755.74121 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.47734 	| r_quantile_mean=0.48686 	| r_raw_sum=120.48764 	|  r_raw_mean=0.24792 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20693
MainProcess| 2024-07-21 21:53:59,176,176 multiprocessing INFO [Test epoch=0023]  nevals=11500 	| train_loss=7082.64795 	| eqs_invalid %=1.20 	| r_best=0.72143 	| quantile=0.48241 	| r_quantile_mean=0.50508 	| r_raw_sum=126.72220 	|  r_raw_mean=0.25652 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21004
MainProcess| 2024-07-21 21:53:59,374,374 multiprocessing INFO [Test epoch=0024]  nevals=12000 	| train_loss=6260.41797 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46161 	| r_quantile_mean=0.48105 	| r_raw_sum=133.87194 	|  r_raw_mean=0.27321 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19838
MainProcess| 2024-07-21 21:53:59,576,576 multiprocessing INFO [Test epoch=0025]  nevals=12500 	| train_loss=6172.26465 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.44349 	| r_quantile_mean=0.48083 	| r_raw_sum=119.94023 	|  r_raw_mean=0.24832 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20181
MainProcess| 2024-07-21 21:53:59,785,785 multiprocessing INFO [Test epoch=0026]  nevals=13000 	| train_loss=6245.32031 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47244 	| r_quantile_mean=0.48762 	| r_raw_sum=125.85144 	|  r_raw_mean=0.25949 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20862
MainProcess| 2024-07-21 21:53:59,993,993 multiprocessing INFO [Test epoch=0027]  nevals=13500 	| train_loss=6235.71533 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.46014 	| r_quantile_mean=0.51194 	| r_raw_sum=125.52291 	|  r_raw_mean=0.25775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20744
MainProcess| 2024-07-21 21:54:00,207,207 multiprocessing INFO [Test epoch=0028]  nevals=14000 	| train_loss=7347.65674 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.46601 	| r_quantile_mean=0.48282 	| r_raw_sum=117.52662 	|  r_raw_mean=0.24133 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21408
MainProcess| 2024-07-21 21:54:00,401,401 multiprocessing INFO [Test epoch=0029]  nevals=14500 	| train_loss=8902.38477 	| eqs_invalid %=4.20 	| r_best=0.72143 	| quantile=0.46651 	| r_quantile_mean=0.49406 	| r_raw_sum=120.87560 	|  r_raw_mean=0.25235 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19388
MainProcess| 2024-07-21 21:54:00,625,625 multiprocessing INFO [Test epoch=0030]  nevals=15000 	| train_loss=7317.65332 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47070 	| r_quantile_mean=0.48047 	| r_raw_sum=125.09400 	|  r_raw_mean=0.25793 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22424
MainProcess| 2024-07-21 21:54:00,625,625 multiprocessing INFO [00:00:00:09.17] Training epoch 30/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:54:00,852,852 multiprocessing INFO [Test epoch=0031]  nevals=15500 	| train_loss=7033.26074 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.45971 	| r_quantile_mean=0.48766 	| r_raw_sum=116.65191 	|  r_raw_mean=0.23904 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22707
MainProcess| 2024-07-21 21:54:01,084,84 multiprocessing INFO [Test epoch=0032]  nevals=16000 	| train_loss=3798.36108 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.43345 	| r_quantile_mean=0.44658 	| r_raw_sum=121.04166 	|  r_raw_mean=0.24906 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23184
MainProcess| 2024-07-21 21:54:01,295,295 multiprocessing INFO [Test epoch=0033]  nevals=16500 	| train_loss=3115.84937 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.46624 	| r_quantile_mean=0.49713 	| r_raw_sum=120.88910 	|  r_raw_mean=0.25081 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21023
MainProcess| 2024-07-21 21:54:01,511,511 multiprocessing INFO [Test epoch=0034]  nevals=17000 	| train_loss=7248.01172 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.43887 	| r_quantile_mean=0.48394 	| r_raw_sum=119.55657 	|  r_raw_mean=0.24856 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21557
MainProcess| 2024-07-21 21:54:01,714,714 multiprocessing INFO [Test epoch=0035]  nevals=17500 	| train_loss=6026.60791 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.46618 	| r_quantile_mean=0.48973 	| r_raw_sum=126.75618 	|  r_raw_mean=0.26298 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20322
MainProcess| 2024-07-21 21:54:01,928,928 multiprocessing INFO [Test epoch=0036]  nevals=18000 	| train_loss=5276.56104 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.44953 	| r_quantile_mean=0.46508 	| r_raw_sum=122.65289 	|  r_raw_mean=0.25237 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21437
MainProcess| 2024-07-21 21:54:02,148,148 multiprocessing INFO [Test epoch=0037]  nevals=18500 	| train_loss=7172.93506 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45863 	| r_quantile_mean=0.51337 	| r_raw_sum=116.72545 	|  r_raw_mean=0.24267 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21946
MainProcess| 2024-07-21 21:54:02,379,379 multiprocessing INFO [Test epoch=0038]  nevals=19000 	| train_loss=7138.16406 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45420 	| r_quantile_mean=0.48204 	| r_raw_sum=116.30314 	|  r_raw_mean=0.23931 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23074
MainProcess| 2024-07-21 21:54:02,606,606 multiprocessing INFO [Test epoch=0039]  nevals=19500 	| train_loss=7090.97119 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.48412 	| r_quantile_mean=0.50056 	| r_raw_sum=123.50769 	|  r_raw_mean=0.25731 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22647
MainProcess| 2024-07-21 21:54:02,835,835 multiprocessing INFO [Test epoch=0040]  nevals=20000 	| train_loss=6573.69775 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.46565 	| r_quantile_mean=0.48457 	| r_raw_sum=122.57255 	|  r_raw_mean=0.25377 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22969
MainProcess| 2024-07-21 21:54:02,836,836 multiprocessing INFO [00:00:00:11.38] Training epoch 40/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:54:03,045,45 multiprocessing INFO [Test epoch=0041]  nevals=20500 	| train_loss=5153.63232 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.47392 	| r_quantile_mean=0.48803 	| r_raw_sum=117.02543 	|  r_raw_mean=0.24380 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20933
MainProcess| 2024-07-21 21:54:03,251,251 multiprocessing INFO [Test epoch=0042]  nevals=21000 	| train_loss=6093.63379 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.46765 	| r_quantile_mean=0.47887 	| r_raw_sum=129.22568 	|  r_raw_mean=0.26590 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20626
MainProcess| 2024-07-21 21:54:03,448,448 multiprocessing INFO [Test epoch=0043]  nevals=21500 	| train_loss=6646.99854 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.44415 	| r_quantile_mean=0.46894 	| r_raw_sum=119.64794 	|  r_raw_mean=0.24772 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19692
MainProcess| 2024-07-21 21:54:03,651,651 multiprocessing INFO [Test epoch=0044]  nevals=22000 	| train_loss=8077.42188 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.46343 	| r_quantile_mean=0.49440 	| r_raw_sum=124.05449 	|  r_raw_mean=0.25266 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20235
MainProcess| 2024-07-21 21:54:03,850,850 multiprocessing INFO [Test epoch=0045]  nevals=22500 	| train_loss=6588.20850 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.49538 	| r_quantile_mean=0.54029 	| r_raw_sum=122.34149 	|  r_raw_mean=0.25225 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19917
MainProcess| 2024-07-21 21:54:04,046,46 multiprocessing INFO [Test epoch=0046]  nevals=23000 	| train_loss=6580.69727 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.46338 	| r_quantile_mean=0.49256 	| r_raw_sum=114.12238 	|  r_raw_mean=0.23775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19582
MainProcess| 2024-07-21 21:54:04,260,260 multiprocessing INFO [Test epoch=0047]  nevals=23500 	| train_loss=6263.75439 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45758 	| r_quantile_mean=0.51379 	| r_raw_sum=115.83421 	|  r_raw_mean=0.24082 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21404
MainProcess| 2024-07-21 21:54:04,470,470 multiprocessing INFO [Test epoch=0048]  nevals=24000 	| train_loss=5857.32080 	| eqs_invalid %=2.20 	| r_best=0.72143 	| quantile=0.44792 	| r_quantile_mean=0.48207 	| r_raw_sum=127.27993 	|  r_raw_mean=0.26029 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20958
MainProcess| 2024-07-21 21:54:04,676,676 multiprocessing INFO [Test epoch=0049]  nevals=24500 	| train_loss=2955.92456 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.44301 	| r_quantile_mean=0.49061 	| r_raw_sum=122.17117 	|  r_raw_mean=0.25399 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20556
MainProcess| 2024-07-21 21:54:05,009,9 multiprocessing INFO [Test epoch=0050]  nevals=25000 	| train_loss=6183.55859 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45957 	| r_quantile_mean=0.48265 	| r_raw_sum=122.78383 	|  r_raw_mean=0.25527 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.33292
MainProcess| 2024-07-21 21:54:05,009,9 multiprocessing INFO [00:00:00:13.56] Training epoch 50/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:54:05,221,221 multiprocessing INFO [Test epoch=0051]  nevals=25500 	| train_loss=3188.23560 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.44803 	| r_quantile_mean=0.50070 	| r_raw_sum=122.40260 	|  r_raw_mean=0.25290 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21151
MainProcess| 2024-07-21 21:54:05,426,426 multiprocessing INFO [Test epoch=0052]  nevals=26000 	| train_loss=6461.74756 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46167 	| r_quantile_mean=0.50530 	| r_raw_sum=127.48081 	|  r_raw_mean=0.26016 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20523
MainProcess| 2024-07-21 21:54:05,626,626 multiprocessing INFO [Test epoch=0053]  nevals=26500 	| train_loss=7960.96924 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46393 	| r_quantile_mean=0.50087 	| r_raw_sum=128.95581 	|  r_raw_mean=0.26318 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20009
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO [Test epoch=0054]  nevals=27000 	| train_loss=7277.07568 	| eqs_invalid %=2.20 	| r_best=1.00000 	| quantile=0.46843 	| r_quantile_mean=0.60582 	| r_raw_sum=124.78341 	|  r_raw_mean=0.25518 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=0.20422
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO [00:00:00:14.38] Training epoch 54/4000, current best R: 1.0000
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-21 21:54:05,831,831 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:05,834,834 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:54:05,834,834 multiprocessing INFO [00:00:00:14.38] Early stopping criteria met; breaking early.
MainProcess| 2024-07-21 21:54:05,834,834 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-21 21:54:05,834,834 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-21 21:54:06,224,224 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 
Priority queue entry 1:
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:54:06,225,225 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 
Priority queue entry 2:
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Reward: 0.692300447727265
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Traversal: n2,sub,mul,sin,div,x2,sub,sub,x2,add,x1,x1,mul,div,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:54:06,227,227 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 
	                      2
	  ⎛            ⎛ x₂ ⎞⎞ 
	  ⎜-x₁ - x₂⋅sin⎜────⎟⎟ 
	  ⎝            ⎝2⋅x₁⎠⎠ 

MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 
Priority queue entry 3:
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Reward: 0.6805319411385534
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Traversal: add,add,n2,x2,n2,x1,cos,sub,x1,add,n2,mul,add,n2,x1,x1,x2,x1
MainProcess| 2024-07-21 21:54:06,228,228 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 
	                 ⎛              2⎞
	    2     2      ⎜  2 ⎛  2     ⎞ ⎟
	  x₁  + x₂  + cos⎝x₂ ⋅⎝x₁  + x₁⎠ ⎠

MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 
Priority queue entry 4:
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Reward: 0.6609841940521602
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Traversal: mul,add,div,div,x2,x1,sin,add,x1,sub,sub,add,x2,x1,x1,x1,x1,x1
MainProcess| 2024-07-21 21:54:06,229,229 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 
	     ⎛         x₂    ⎞
	  x₁⋅⎜x₁ + ──────────⎟
	     ⎝     x₁⋅sin(x₂)⎠

MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 
Priority queue entry 5:
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Reward: 0.6217502159179428
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Traversal: add,mul,sub,x1,sin,div,mul,div,x2,x1,x2,x2,x1,add,cos,x1,n2,x2
MainProcess| 2024-07-21 21:54:06,230,230 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,231,231 multiprocessing INFO 
	     ⎛        ⎛x₂⎞⎞     2          
	  x₁⋅⎜x₁ - sin⎜──⎟⎟ + x₂  + cos(x₁)
	     ⎝        ⎝x₁⎠⎠                

MainProcess| 2024-07-21 21:54:06,231,231 multiprocessing INFO 
Priority queue entry 6:
MainProcess| 2024-07-21 21:54:06,231,231 multiprocessing INFO 	Reward: 0.5782056568736673
MainProcess| 2024-07-21 21:54:06,231,231 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,231,231 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,231,231 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,232,232 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,232,232 multiprocessing INFO 	Traversal: sub,add,add,mul,cos,x1,mul,x2,mul,x2,sin,n2,x1,n2,x2,n2,x1,x1
MainProcess| 2024-07-21 21:54:06,232,232 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 
	    2          2    ⎛  2⎞             2
	  x₁  - x₁ + x₂ ⋅sin⎝x₁ ⎠⋅cos(x₁) + x₂ 

MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 
Priority queue entry 7:
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Reward: 0.5764576150129798
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Traversal: add,n2,x1,add,mul,x2,add,cos,mul,div,x2,add,sub,mul,x2,x1,x1,x2,x2,x2,x1
MainProcess| 2024-07-21 21:54:06,233,233 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 
	                ⎛        ⎛        2      ⎞⎞
	    2           ⎜        ⎜      x₂       ⎟⎟
	  x₁  + x₁ + x₂⋅⎜x₂ + cos⎜───────────────⎟⎟
	                ⎝        ⎝x₁⋅x₂ - x₁ + x₂⎠⎠

MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 
Priority queue entry 8:
MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 	Reward: 0.5671309013236785
MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,234,234 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Traversal: add,mul,x2,x2,n2,cos,div,x2,mul,mul,x1,x1,sub,sub,x2,x2,x2
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 
	    2      2⎛ 1 ⎞
	  x₂  + cos ⎜───⎟
	            ⎜  2⎟
	            ⎝x₁ ⎠

MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 
Priority queue entry 9:
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Reward: 0.5639053892928447
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Traversal: add,n2,x2,sin,n2,div,x1,x1
MainProcess| 2024-07-21 21:54:06,235,235 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:54:06,236,236 multiprocessing INFO 
	    2         
	  x₂  + sin(1)

MainProcess| 2024-07-21 21:54:06,236,236 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-21 21:54:06,238,238 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-21 21:54:06,238,238 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-21 21:54:06,238,238 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-21 21:54:06,300,300 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-21 21:54:06,449,449 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-21 21:54:06,449,449 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-21-215350_0/summary.csv'
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-21-215350_0
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO Found issues:
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO   0
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:54:06,450,450 multiprocessing INFO     1: S=000 R=0.721433 <-- [x1**2 + x2*(x2 + sin((-x1 + x2**2/x1)/x1))]
MainProcess| 2024-07-21 21:54:06,451,451 multiprocessing INFO     2: S=000 R=0.692300 <-- [(-x1 - x2*sin(x2/(2*x1)))**2]
MainProcess| 2024-07-21 21:54:06,451,451 multiprocessing INFO     3: S=000 R=0.680532 <-- [x1**2 + x2**2 + cos(x2**2*(x1**2 + x1)**2)]
MainProcess| 2024-07-21 21:54:06,451,451 multiprocessing INFO     4: S=000 R=0.660984 <-- [x1*(x1 + x2/(x1*sin(x2)))]
MainProcess| 2024-07-21 21:54:06,451,451 multiprocessing INFO Pareto Front (5 of 6)____
MainProcess| 2024-07-21 21:54:06,452,452 multiprocessing INFO     0: S=000 R=1.000000 C=21.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:54:06,452,452 multiprocessing INFO     1: S=000 R=0.565633 C=11.00 <-- [x1**2*x2/sin(x2)]
MainProcess| 2024-07-21 21:54:06,452,452 multiprocessing INFO     2: S=000 R=0.514932 C=10.00 <-- [(x1 - x2 + sin(x2))**2]
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO     3: S=000 R=0.496751 C=8.00 <-- [(-x1 + cos(x1))**2]
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO     4: S=000 R=0.435535 C=6.00 <-- [x1*sin(x1)]
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 14.785611391067505, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO INFO: Completed run 1 of 1 in 15 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 14.785611391067505, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:54:06,453,453 multiprocessing INFO Fin.
MainProcess| 2024-07-21 21:54:06,454,454 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 21:57:09,102,102 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 21:57:09,102,102 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:57:09,102,102 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 21:57:09,103,103 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 21:57:09,212,212 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-21 21:57:09,213,213 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-21 21:57:09,267,267 multiprocessing INFO Running model : dso
MainProcess| 2024-07-21 21:57:09,271,271 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-21 21:57:10,112,112 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-21 21:57:10,117,117 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-21-215709', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-21-215709_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98291 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.48264 	| r_quantile_mean=0.48999 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=2.93721
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO [00:00:00:02.94] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-21 21:57:13,061,61 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:13,198,198 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02002 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.47344 	| r_quantile_mean=0.49624 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.21218
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO [00:00:00:03.29] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:13,411,411 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:57:13,412,412 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:13,421,421 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-21 21:57:13,646,646 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.19336 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.46628 	| r_quantile_mean=0.49914 	| r_raw_sum=129.25510 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.22548
MainProcess| 2024-07-21 21:57:13,646,646 multiprocessing INFO [00:00:00:03.52] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-21 21:57:13,646,646 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:57:13,646,646 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-21 21:57:13,646,646 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:13,646,646 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:13,647,647 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:13,647,647 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:13,647,647 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-21 21:57:13,647,647 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:13,649,649 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-21 21:57:13,872,872 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.71289 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.46473 	| r_quantile_mean=0.47559 	| r_raw_sum=117.54185 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.22300
MainProcess| 2024-07-21 21:57:14,082,82 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.17090 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.47530 	| r_quantile_mean=0.48596 	| r_raw_sum=128.26342 	|  r_raw_mean=0.26283 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.21044
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.36084 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.47117 	| r_quantile_mean=0.52967 	| r_raw_sum=120.16180 	|  r_raw_mean=0.24878 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22736
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO [00:00:00:04.19] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:57:14,310,310 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:14,317,317 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:57:14,536,536 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.10498 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.46067 	| r_quantile_mean=0.46984 	| r_raw_sum=127.93508 	|  r_raw_mean=0.26216 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21898
MainProcess| 2024-07-21 21:57:14,743,743 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.00537 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.48430 	| r_quantile_mean=0.48865 	| r_raw_sum=128.22742 	|  r_raw_mean=0.26330 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20697
MainProcess| 2024-07-21 21:57:14,969,969 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.37842 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.46033 	| r_quantile_mean=0.47904 	| r_raw_sum=129.50090 	|  r_raw_mean=0.26756 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22553
MainProcess| 2024-07-21 21:57:15,206,206 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7155.97852 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47094 	| r_quantile_mean=0.50096 	| r_raw_sum=121.65239 	|  r_raw_mean=0.24980 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23755
MainProcess| 2024-07-21 21:57:15,207,207 multiprocessing INFO [00:00:00:05.08] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:57:15,565,565 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5833.21191 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45977 	| r_quantile_mean=0.47310 	| r_raw_sum=124.93872 	|  r_raw_mean=0.25708 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.35875
MainProcess| 2024-07-21 21:57:15,762,762 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.75781 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.45748 	| r_quantile_mean=0.47683 	| r_raw_sum=126.19979 	|  r_raw_mean=0.25755 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19665
MainProcess| 2024-07-21 21:57:15,967,967 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6806.96680 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.45037 	| r_quantile_mean=0.46860 	| r_raw_sum=116.02136 	|  r_raw_mean=0.23922 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20437
MainProcess| 2024-07-21 21:57:16,174,174 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.34180 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47446 	| r_quantile_mean=0.50009 	| r_raw_sum=124.27290 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20708
MainProcess| 2024-07-21 21:57:16,395,395 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6366.23828 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.46775 	| r_quantile_mean=0.52274 	| r_raw_sum=121.59467 	|  r_raw_mean=0.25280 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22115
MainProcess| 2024-07-21 21:57:16,604,604 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6353.54395 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46312 	| r_quantile_mean=0.51069 	| r_raw_sum=129.73545 	|  r_raw_mean=0.26477 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20866
MainProcess| 2024-07-21 21:57:16,832,832 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=6886.15430 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47073 	| r_quantile_mean=0.48576 	| r_raw_sum=122.36201 	|  r_raw_mean=0.25126 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22768
MainProcess| 2024-07-21 21:57:17,041,41 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7471.12695 	| eqs_invalid %=1.40 	| r_best=0.72143 	| quantile=0.47487 	| r_quantile_mean=0.48683 	| r_raw_sum=121.78742 	|  r_raw_mean=0.24703 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20902
MainProcess| 2024-07-21 21:57:17,245,245 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=7493.12402 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.43365 	| r_quantile_mean=0.47038 	| r_raw_sum=121.43672 	|  r_raw_mean=0.24987 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20332
MainProcess| 2024-07-21 21:57:17,459,459 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=7474.82080 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.43368 	| r_quantile_mean=0.46999 	| r_raw_sum=121.92947 	|  r_raw_mean=0.24833 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21460
MainProcess| 2024-07-21 21:57:17,460,460 multiprocessing INFO [00:00:00:07.34] Training epoch 20/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:57:17,666,666 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=6242.10059 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.46892 	| r_quantile_mean=0.54189 	| r_raw_sum=120.16841 	|  r_raw_mean=0.25035 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20600
MainProcess| 2024-07-21 21:57:17,870,870 multiprocessing INFO [Test epoch=0022]  nevals=11000 	| train_loss=6755.74121 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.47734 	| r_quantile_mean=0.48686 	| r_raw_sum=120.48764 	|  r_raw_mean=0.24792 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20384
MainProcess| 2024-07-21 21:57:18,077,77 multiprocessing INFO [Test epoch=0023]  nevals=11500 	| train_loss=7082.64795 	| eqs_invalid %=1.20 	| r_best=0.72143 	| quantile=0.48241 	| r_quantile_mean=0.50508 	| r_raw_sum=126.72220 	|  r_raw_mean=0.25652 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20702
MainProcess| 2024-07-21 21:57:18,280,280 multiprocessing INFO [Test epoch=0024]  nevals=12000 	| train_loss=6260.41797 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46161 	| r_quantile_mean=0.48105 	| r_raw_sum=133.87194 	|  r_raw_mean=0.27321 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20327
MainProcess| 2024-07-21 21:57:18,482,482 multiprocessing INFO [Test epoch=0025]  nevals=12500 	| train_loss=6172.26465 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.44349 	| r_quantile_mean=0.48083 	| r_raw_sum=119.94023 	|  r_raw_mean=0.24832 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20203
MainProcess| 2024-07-21 21:57:18,687,687 multiprocessing INFO [Test epoch=0026]  nevals=13000 	| train_loss=6245.32031 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47244 	| r_quantile_mean=0.48762 	| r_raw_sum=125.85144 	|  r_raw_mean=0.25949 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20431
MainProcess| 2024-07-21 21:57:18,891,891 multiprocessing INFO [Test epoch=0027]  nevals=13500 	| train_loss=6235.71533 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.46014 	| r_quantile_mean=0.51194 	| r_raw_sum=125.52291 	|  r_raw_mean=0.25775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20404
MainProcess| 2024-07-21 21:57:19,094,94 multiprocessing INFO [Test epoch=0028]  nevals=14000 	| train_loss=7347.65674 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.46601 	| r_quantile_mean=0.48282 	| r_raw_sum=117.52662 	|  r_raw_mean=0.24133 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20251
MainProcess| 2024-07-21 21:57:19,330,330 multiprocessing INFO [Test epoch=0029]  nevals=14500 	| train_loss=8902.38477 	| eqs_invalid %=4.20 	| r_best=0.72143 	| quantile=0.46651 	| r_quantile_mean=0.49406 	| r_raw_sum=120.87560 	|  r_raw_mean=0.25235 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23616
MainProcess| 2024-07-21 21:57:19,557,557 multiprocessing INFO [Test epoch=0030]  nevals=15000 	| train_loss=7317.65332 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47070 	| r_quantile_mean=0.48047 	| r_raw_sum=125.09400 	|  r_raw_mean=0.25793 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22638
MainProcess| 2024-07-21 21:57:19,557,557 multiprocessing INFO [00:00:00:09.43] Training epoch 30/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:57:19,780,780 multiprocessing INFO [Test epoch=0031]  nevals=15500 	| train_loss=7033.26074 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.45971 	| r_quantile_mean=0.48766 	| r_raw_sum=116.65191 	|  r_raw_mean=0.23904 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22360
MainProcess| 2024-07-21 21:57:20,002,2 multiprocessing INFO [Test epoch=0032]  nevals=16000 	| train_loss=3798.36108 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.43345 	| r_quantile_mean=0.44658 	| r_raw_sum=121.04166 	|  r_raw_mean=0.24906 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22170
MainProcess| 2024-07-21 21:57:20,219,219 multiprocessing INFO [Test epoch=0033]  nevals=16500 	| train_loss=3115.84937 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.46624 	| r_quantile_mean=0.49713 	| r_raw_sum=120.88910 	|  r_raw_mean=0.25081 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21639
MainProcess| 2024-07-21 21:57:20,459,459 multiprocessing INFO [Test epoch=0034]  nevals=17000 	| train_loss=7248.01172 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.43887 	| r_quantile_mean=0.48394 	| r_raw_sum=119.55657 	|  r_raw_mean=0.24856 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23982
MainProcess| 2024-07-21 21:57:20,699,699 multiprocessing INFO [Test epoch=0035]  nevals=17500 	| train_loss=6026.60791 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.46618 	| r_quantile_mean=0.48973 	| r_raw_sum=126.75618 	|  r_raw_mean=0.26298 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.23962
MainProcess| 2024-07-21 21:57:20,955,955 multiprocessing INFO [Test epoch=0036]  nevals=18000 	| train_loss=5276.56104 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.44953 	| r_quantile_mean=0.46508 	| r_raw_sum=122.65289 	|  r_raw_mean=0.25237 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.25591
MainProcess| 2024-07-21 21:57:21,205,205 multiprocessing INFO [Test epoch=0037]  nevals=18500 	| train_loss=7172.93506 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45863 	| r_quantile_mean=0.51337 	| r_raw_sum=116.72545 	|  r_raw_mean=0.24267 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.24966
MainProcess| 2024-07-21 21:57:21,451,451 multiprocessing INFO [Test epoch=0038]  nevals=19000 	| train_loss=7138.16406 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45420 	| r_quantile_mean=0.48204 	| r_raw_sum=116.30314 	|  r_raw_mean=0.23931 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.24663
MainProcess| 2024-07-21 21:57:21,694,694 multiprocessing INFO [Test epoch=0039]  nevals=19500 	| train_loss=7090.97119 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.48412 	| r_quantile_mean=0.50056 	| r_raw_sum=123.50769 	|  r_raw_mean=0.25731 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.24219
MainProcess| 2024-07-21 21:57:21,958,958 multiprocessing INFO [Test epoch=0040]  nevals=20000 	| train_loss=6573.69775 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.46565 	| r_quantile_mean=0.48457 	| r_raw_sum=122.57255 	|  r_raw_mean=0.25377 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.26446
MainProcess| 2024-07-21 21:57:21,959,959 multiprocessing INFO [00:00:00:11.84] Training epoch 40/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:57:22,200,200 multiprocessing INFO [Test epoch=0041]  nevals=20500 	| train_loss=5153.63232 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.47392 	| r_quantile_mean=0.48803 	| r_raw_sum=117.02543 	|  r_raw_mean=0.24380 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.24134
MainProcess| 2024-07-21 21:57:22,453,453 multiprocessing INFO [Test epoch=0042]  nevals=21000 	| train_loss=6093.63379 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.46765 	| r_quantile_mean=0.47887 	| r_raw_sum=129.22568 	|  r_raw_mean=0.26590 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.25218
MainProcess| 2024-07-21 21:57:22,659,659 multiprocessing INFO [Test epoch=0043]  nevals=21500 	| train_loss=6646.99854 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.44415 	| r_quantile_mean=0.46894 	| r_raw_sum=119.64794 	|  r_raw_mean=0.24772 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20641
MainProcess| 2024-07-21 21:57:22,888,888 multiprocessing INFO [Test epoch=0044]  nevals=22000 	| train_loss=8077.42188 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.46343 	| r_quantile_mean=0.49440 	| r_raw_sum=124.05449 	|  r_raw_mean=0.25266 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22834
MainProcess| 2024-07-21 21:57:23,103,103 multiprocessing INFO [Test epoch=0045]  nevals=22500 	| train_loss=6588.20850 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.49538 	| r_quantile_mean=0.54029 	| r_raw_sum=122.34149 	|  r_raw_mean=0.25225 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21543
MainProcess| 2024-07-21 21:57:23,317,317 multiprocessing INFO [Test epoch=0046]  nevals=23000 	| train_loss=6580.69727 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.46338 	| r_quantile_mean=0.49256 	| r_raw_sum=114.12238 	|  r_raw_mean=0.23775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21366
MainProcess| 2024-07-21 21:57:23,527,527 multiprocessing INFO [Test epoch=0047]  nevals=23500 	| train_loss=6263.75439 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45758 	| r_quantile_mean=0.51379 	| r_raw_sum=115.83421 	|  r_raw_mean=0.24082 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20953
MainProcess| 2024-07-21 21:57:23,730,730 multiprocessing INFO [Test epoch=0048]  nevals=24000 	| train_loss=5857.32080 	| eqs_invalid %=2.20 	| r_best=0.72143 	| quantile=0.44792 	| r_quantile_mean=0.48207 	| r_raw_sum=127.27993 	|  r_raw_mean=0.26029 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20316
MainProcess| 2024-07-21 21:57:23,936,936 multiprocessing INFO [Test epoch=0049]  nevals=24500 	| train_loss=2955.92456 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.44301 	| r_quantile_mean=0.49061 	| r_raw_sum=122.17117 	|  r_raw_mean=0.25399 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20583
MainProcess| 2024-07-21 21:57:24,142,142 multiprocessing INFO [Test epoch=0050]  nevals=25000 	| train_loss=6183.55859 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45957 	| r_quantile_mean=0.48265 	| r_raw_sum=122.78383 	|  r_raw_mean=0.25527 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20538
MainProcess| 2024-07-21 21:57:24,142,142 multiprocessing INFO [00:00:00:14.02] Training epoch 50/4000, current best R: 0.7214
MainProcess| 2024-07-21 21:57:24,389,389 multiprocessing INFO [Test epoch=0051]  nevals=25500 	| train_loss=3188.23560 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.44803 	| r_quantile_mean=0.50070 	| r_raw_sum=122.40260 	|  r_raw_mean=0.25290 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.24704
MainProcess| 2024-07-21 21:57:24,618,618 multiprocessing INFO [Test epoch=0052]  nevals=26000 	| train_loss=6461.74756 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46167 	| r_quantile_mean=0.50530 	| r_raw_sum=127.48081 	|  r_raw_mean=0.26016 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22868
MainProcess| 2024-07-21 21:57:24,835,835 multiprocessing INFO [Test epoch=0053]  nevals=26500 	| train_loss=7960.96924 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46393 	| r_quantile_mean=0.50087 	| r_raw_sum=128.95581 	|  r_raw_mean=0.26318 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21756
MainProcess| 2024-07-21 21:57:25,050,50 multiprocessing INFO [Test epoch=0054]  nevals=27000 	| train_loss=7277.07568 	| eqs_invalid %=2.20 	| r_best=1.00000 	| quantile=0.46843 	| r_quantile_mean=0.60582 	| r_raw_sum=124.78341 	|  r_raw_mean=0.25518 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=0.21484
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO [00:00:00:14.93] Training epoch 54/4000, current best R: 1.0000
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 
	** New best
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-21 21:57:25,051,51 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,054,54 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:57:25,054,54 multiprocessing INFO [00:00:00:14.93] Early stopping criteria met; breaking early.
MainProcess| 2024-07-21 21:57:25,054,54 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-21 21:57:25,054,54 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-21 21:57:25,589,589 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 
Priority queue entry 1:
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-21 21:57:25,590,590 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 
Priority queue entry 2:
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 	Reward: 0.692300447727265
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,591,591 multiprocessing INFO 	Traversal: n2,sub,mul,sin,div,x2,sub,sub,x2,add,x1,x1,mul,div,x2,x2,x2,x2,x1
MainProcess| 2024-07-21 21:57:25,592,592 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,592,592 multiprocessing INFO 
	                      2
	  ⎛            ⎛ x₂ ⎞⎞ 
	  ⎜-x₁ - x₂⋅sin⎜────⎟⎟ 
	  ⎝            ⎝2⋅x₁⎠⎠ 

MainProcess| 2024-07-21 21:57:25,592,592 multiprocessing INFO 
Priority queue entry 3:
MainProcess| 2024-07-21 21:57:25,592,592 multiprocessing INFO 	Reward: 0.6805319411385534
MainProcess| 2024-07-21 21:57:25,593,593 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,593,593 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,593,593 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,593,593 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,593,593 multiprocessing INFO 	Traversal: add,add,n2,x2,n2,x1,cos,sub,x1,add,n2,mul,add,n2,x1,x1,x2,x1
MainProcess| 2024-07-21 21:57:25,593,593 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 
	                 ⎛              2⎞
	    2     2      ⎜  2 ⎛  2     ⎞ ⎟
	  x₁  + x₂  + cos⎝x₂ ⋅⎝x₁  + x₁⎠ ⎠

MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 
Priority queue entry 4:
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Reward: 0.6609841940521602
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Traversal: mul,add,div,div,x2,x1,sin,add,x1,sub,sub,add,x2,x1,x1,x1,x1,x1
MainProcess| 2024-07-21 21:57:25,594,594 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 
	     ⎛         x₂    ⎞
	  x₁⋅⎜x₁ + ──────────⎟
	     ⎝     x₁⋅sin(x₂)⎠

MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 
Priority queue entry 5:
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Reward: 0.6217502159179428
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Traversal: add,mul,sub,x1,sin,div,mul,div,x2,x1,x2,x2,x1,add,cos,x1,n2,x2
MainProcess| 2024-07-21 21:57:25,595,595 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 
	     ⎛        ⎛x₂⎞⎞     2          
	  x₁⋅⎜x₁ - sin⎜──⎟⎟ + x₂  + cos(x₁)
	     ⎝        ⎝x₁⎠⎠                

MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 
Priority queue entry 6:
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Reward: 0.5782056568736673
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Traversal: sub,add,add,mul,cos,x1,mul,x2,mul,x2,sin,n2,x1,n2,x2,n2,x1,x1
MainProcess| 2024-07-21 21:57:25,596,596 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,597,597 multiprocessing INFO 
	    2          2    ⎛  2⎞             2
	  x₁  - x₁ + x₂ ⋅sin⎝x₁ ⎠⋅cos(x₁) + x₂ 

MainProcess| 2024-07-21 21:57:25,597,597 multiprocessing INFO 
Priority queue entry 7:
MainProcess| 2024-07-21 21:57:25,597,597 multiprocessing INFO 	Reward: 0.5764576150129798
MainProcess| 2024-07-21 21:57:25,597,597 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,597,597 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,597,597 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,598,598 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,598,598 multiprocessing INFO 	Traversal: add,n2,x1,add,mul,x2,add,cos,mul,div,x2,add,sub,mul,x2,x1,x1,x2,x2,x2,x1
MainProcess| 2024-07-21 21:57:25,598,598 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 
	                ⎛        ⎛        2      ⎞⎞
	    2           ⎜        ⎜      x₂       ⎟⎟
	  x₁  + x₁ + x₂⋅⎜x₂ + cos⎜───────────────⎟⎟
	                ⎝        ⎝x₁⋅x₂ - x₁ + x₂⎠⎠

MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 
Priority queue entry 8:
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Reward: 0.5671309013236785
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Traversal: add,mul,x2,x2,n2,cos,div,x2,mul,mul,x1,x1,sub,sub,x2,x2,x2
MainProcess| 2024-07-21 21:57:25,599,599 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 
	    2      2⎛ 1 ⎞
	  x₂  + cos ⎜───⎟
	            ⎜  2⎟
	            ⎝x₁ ⎠

MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 
Priority queue entry 9:
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Reward: 0.5639053892928447
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Traversal: add,n2,x2,sin,n2,div,x1,x1
MainProcess| 2024-07-21 21:57:25,600,600 multiprocessing INFO 	Expression:
MainProcess| 2024-07-21 21:57:25,601,601 multiprocessing INFO 
	    2         
	  x₂  + sin(1)

MainProcess| 2024-07-21 21:57:25,601,601 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-21 21:57:25,602,602 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-21 21:57:25,602,602 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-21 21:57:25,602,602 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-21 21:57:25,670,670 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-21 21:57:25,816,816 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-21 21:57:25,816,816 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-21 21:57:25,816,816 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-21-215709_0/summary.csv'
MainProcess| 2024-07-21 21:57:25,816,816 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-21-215709_0
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO Found issues:
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO   0
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:57:25,817,817 multiprocessing INFO     1: S=000 R=0.721433 <-- [x1**2 + x2*(x2 + sin((-x1 + x2**2/x1)/x1))]
MainProcess| 2024-07-21 21:57:25,818,818 multiprocessing INFO     2: S=000 R=0.692300 <-- [(-x1 - x2*sin(x2/(2*x1)))**2]
MainProcess| 2024-07-21 21:57:25,818,818 multiprocessing INFO     3: S=000 R=0.680532 <-- [x1**2 + x2**2 + cos(x2**2*(x1**2 + x1)**2)]
MainProcess| 2024-07-21 21:57:25,818,818 multiprocessing INFO     4: S=000 R=0.660984 <-- [x1*(x1 + x2/(x1*sin(x2)))]
MainProcess| 2024-07-21 21:57:25,818,818 multiprocessing INFO Pareto Front (5 of 6)____
MainProcess| 2024-07-21 21:57:25,819,819 multiprocessing INFO     0: S=000 R=1.000000 C=21.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-21 21:57:25,819,819 multiprocessing INFO     1: S=000 R=0.565633 C=11.00 <-- [x1**2*x2/sin(x2)]
MainProcess| 2024-07-21 21:57:25,819,819 multiprocessing INFO     2: S=000 R=0.514932 C=10.00 <-- [(x1 - x2 + sin(x2))**2]
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO     3: S=000 R=0.496751 C=8.00 <-- [(-x1 + cos(x1))**2]
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO     4: S=000 R=0.435535 C=6.00 <-- [x1*sin(x1)]
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 15.479137182235718, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO INFO: Completed run 1 of 1 in 15 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 15.479137182235718, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-21 21:57:25,820,820 multiprocessing INFO Fin.
MainProcess| 2024-07-21 21:57:25,821,821 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 22:05:04,320,320 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 22:05:04,320,320 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:05:04,321,321 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:05:04,322,322 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 22:05:04,428,428 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 22:06:30,873,873 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 22:06:30,873,873 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:06:30,873,873 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:06:30,875,875 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 22:06:31,003,3 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 22:07:18,771,771 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 22:07:18,771,771 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:07:18,771,771 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:07:18,772,772 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 22:07:18,880,880 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 22:09:52,569,569 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 22:09:52,569,569 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:09:52,569,569 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:09:52,571,571 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 22:09:52,684,684 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 22:10:24,155,155 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 22:10:24,155,155 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:10:24,155,155 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:10:24,156,156 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 22:10:24,266,266 multiprocessing INFO process shutting down
MainProcess| 2024-07-21 22:11:56,235,235 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-21 22:11:56,235,235 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:11:56,235,235 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-21 22:11:56,237,237 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-21 22:11:56,350,350 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:46:00,443,443 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:46:00,444,444 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:46:00,444,444 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:46:00,445,445 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:46:00,555,555 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:46:41,986,986 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:46:41,986,986 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:46:41,986,986 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:46:41,988,988 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:46:42,107,107 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:48:53,513,513 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:48:53,513,513 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:48:53,513,513 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:48:53,515,515 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:48:53,623,623 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 00:48:53,624,624 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 00:48:53,676,676 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 00:48:53,681,681 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 00:48:54,564,564 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 00:48:54,570,570 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-004853', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-004853_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 00:48:57,576,576 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98291 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.48264 	| r_quantile_mean=0.48999 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=2.99945
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO [00:00:00:03.00] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 00:48:57,577,577 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:48:57,717,717 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02002 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.47344 	| r_quantile_mean=0.49624 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.18395
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO [00:00:00:03.32] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-22 00:48:57,901,901 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:48:57,908,908 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-22 00:48:58,099,99 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.19336 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.46628 	| r_quantile_mean=0.49914 	| r_raw_sum=129.25510 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.19153
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO [00:00:00:03.52] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-22 00:48:58,100,100 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:48:58,104,104 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-22 00:48:58,317,317 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.71289 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.46473 	| r_quantile_mean=0.47559 	| r_raw_sum=117.54185 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.21327
MainProcess| 2024-07-22 00:48:58,507,507 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.17090 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.47530 	| r_quantile_mean=0.48596 	| r_raw_sum=128.26342 	|  r_raw_mean=0.26283 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.18966
MainProcess| 2024-07-22 00:48:58,690,690 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.36084 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.47117 	| r_quantile_mean=0.52967 	| r_raw_sum=120.16180 	|  r_raw_mean=0.24878 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18341
MainProcess| 2024-07-22 00:48:58,690,690 multiprocessing INFO [00:00:00:04.11] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-22 00:48:58,691,691 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:48:58,697,697 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-22 00:48:58,892,892 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.10498 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.46067 	| r_quantile_mean=0.46984 	| r_raw_sum=127.93508 	|  r_raw_mean=0.26216 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19499
MainProcess| 2024-07-22 00:48:59,074,74 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.00537 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.48430 	| r_quantile_mean=0.48865 	| r_raw_sum=128.22742 	|  r_raw_mean=0.26330 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18159
MainProcess| 2024-07-22 00:48:59,261,261 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.37842 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.46033 	| r_quantile_mean=0.47904 	| r_raw_sum=129.50090 	|  r_raw_mean=0.26756 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18664
MainProcess| 2024-07-22 00:48:59,441,441 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7155.97852 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47094 	| r_quantile_mean=0.50096 	| r_raw_sum=121.65239 	|  r_raw_mean=0.24980 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18027
MainProcess| 2024-07-22 00:48:59,441,441 multiprocessing INFO [00:00:00:04.86] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-22 00:48:59,739,739 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5833.21191 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45977 	| r_quantile_mean=0.47310 	| r_raw_sum=124.93872 	|  r_raw_mean=0.25708 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29815
MainProcess| 2024-07-22 00:48:59,940,940 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.75781 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.45748 	| r_quantile_mean=0.47683 	| r_raw_sum=126.19979 	|  r_raw_mean=0.25755 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20034
MainProcess| 2024-07-22 00:49:00,129,129 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6806.96680 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.45037 	| r_quantile_mean=0.46860 	| r_raw_sum=116.02136 	|  r_raw_mean=0.23922 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18864
MainProcess| 2024-07-22 00:49:00,349,349 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.34180 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47446 	| r_quantile_mean=0.50009 	| r_raw_sum=124.27290 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22023
MainProcess| 2024-07-22 00:49:00,533,533 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6366.23828 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.46775 	| r_quantile_mean=0.52274 	| r_raw_sum=121.59467 	|  r_raw_mean=0.25280 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18426
MainProcess| 2024-07-22 00:49:00,716,716 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6353.54395 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46312 	| r_quantile_mean=0.51069 	| r_raw_sum=129.73545 	|  r_raw_mean=0.26477 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18261
MainProcess| 2024-07-22 00:49:00,907,907 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=6886.15430 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.47073 	| r_quantile_mean=0.48576 	| r_raw_sum=122.36201 	|  r_raw_mean=0.25126 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19077
MainProcess| 2024-07-22 00:49:01,098,98 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7471.12695 	| eqs_invalid %=1.40 	| r_best=0.72143 	| quantile=0.47487 	| r_quantile_mean=0.48683 	| r_raw_sum=121.78742 	|  r_raw_mean=0.24703 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19103
MainProcess| 2024-07-22 00:49:01,280,280 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=7493.12402 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.43365 	| r_quantile_mean=0.47038 	| r_raw_sum=121.43672 	|  r_raw_mean=0.24987 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18114
MainProcess| 2024-07-22 00:49:01,467,467 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=7474.82080 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.43368 	| r_quantile_mean=0.46999 	| r_raw_sum=121.92947 	|  r_raw_mean=0.24833 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18756
MainProcess| 2024-07-22 00:49:01,467,467 multiprocessing INFO [00:00:00:06.89] Training epoch 20/4000, current best R: 0.7214
MainProcess| 2024-07-22 00:49:01,666,666 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=6242.10059 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.46892 	| r_quantile_mean=0.54189 	| r_raw_sum=120.16841 	|  r_raw_mean=0.25035 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19898
MainProcess| 2024-07-22 00:49:01,881,881 multiprocessing INFO [Test epoch=0022]  nevals=11000 	| train_loss=6755.74121 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.47734 	| r_quantile_mean=0.48686 	| r_raw_sum=120.48764 	|  r_raw_mean=0.24792 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21416
MainProcess| 2024-07-22 00:49:02,069,69 multiprocessing INFO [Test epoch=0023]  nevals=11500 	| train_loss=7082.64795 	| eqs_invalid %=1.20 	| r_best=0.72143 	| quantile=0.48241 	| r_quantile_mean=0.50508 	| r_raw_sum=126.72220 	|  r_raw_mean=0.25652 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18812
MainProcess| 2024-07-22 00:49:02,267,267 multiprocessing INFO [Test epoch=0024]  nevals=12000 	| train_loss=6260.41797 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46161 	| r_quantile_mean=0.48105 	| r_raw_sum=133.87194 	|  r_raw_mean=0.27321 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19773
MainProcess| 2024-07-22 00:49:02,489,489 multiprocessing INFO [Test epoch=0025]  nevals=12500 	| train_loss=6172.26465 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.44349 	| r_quantile_mean=0.48083 	| r_raw_sum=119.94023 	|  r_raw_mean=0.24832 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22236
MainProcess| 2024-07-22 00:49:02,718,718 multiprocessing INFO [Test epoch=0026]  nevals=13000 	| train_loss=6245.32031 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47244 	| r_quantile_mean=0.48762 	| r_raw_sum=125.85144 	|  r_raw_mean=0.25949 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22807
MainProcess| 2024-07-22 00:49:02,898,898 multiprocessing INFO [Test epoch=0027]  nevals=13500 	| train_loss=6235.71533 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.46014 	| r_quantile_mean=0.51194 	| r_raw_sum=125.52291 	|  r_raw_mean=0.25775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18029
MainProcess| 2024-07-22 00:49:03,084,84 multiprocessing INFO [Test epoch=0028]  nevals=14000 	| train_loss=7347.65674 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.46601 	| r_quantile_mean=0.48282 	| r_raw_sum=117.52662 	|  r_raw_mean=0.24133 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18600
MainProcess| 2024-07-22 00:49:03,267,267 multiprocessing INFO [Test epoch=0029]  nevals=14500 	| train_loss=8902.38477 	| eqs_invalid %=4.20 	| r_best=0.72143 	| quantile=0.46651 	| r_quantile_mean=0.49406 	| r_raw_sum=120.87560 	|  r_raw_mean=0.25235 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18275
MainProcess| 2024-07-22 00:49:03,455,455 multiprocessing INFO [Test epoch=0030]  nevals=15000 	| train_loss=7317.65332 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.47070 	| r_quantile_mean=0.48047 	| r_raw_sum=125.09400 	|  r_raw_mean=0.25793 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18779
MainProcess| 2024-07-22 00:49:03,455,455 multiprocessing INFO [00:00:00:08.88] Training epoch 30/4000, current best R: 0.7214
MainProcess| 2024-07-22 00:49:03,668,668 multiprocessing INFO [Test epoch=0031]  nevals=15500 	| train_loss=7033.26074 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.45971 	| r_quantile_mean=0.48766 	| r_raw_sum=116.65191 	|  r_raw_mean=0.23904 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.21307
MainProcess| 2024-07-22 00:49:03,869,869 multiprocessing INFO [Test epoch=0032]  nevals=16000 	| train_loss=3798.36108 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.43345 	| r_quantile_mean=0.44658 	| r_raw_sum=121.04166 	|  r_raw_mean=0.24906 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20050
MainProcess| 2024-07-22 00:49:04,060,60 multiprocessing INFO [Test epoch=0033]  nevals=16500 	| train_loss=3115.84937 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.46624 	| r_quantile_mean=0.49713 	| r_raw_sum=120.88910 	|  r_raw_mean=0.25081 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19076
MainProcess| 2024-07-22 00:49:04,252,252 multiprocessing INFO [Test epoch=0034]  nevals=17000 	| train_loss=7248.01172 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.43887 	| r_quantile_mean=0.48394 	| r_raw_sum=119.55657 	|  r_raw_mean=0.24856 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19187
MainProcess| 2024-07-22 00:49:04,439,439 multiprocessing INFO [Test epoch=0035]  nevals=17500 	| train_loss=6026.60791 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.46618 	| r_quantile_mean=0.48973 	| r_raw_sum=126.75618 	|  r_raw_mean=0.26298 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18725
MainProcess| 2024-07-22 00:49:04,625,625 multiprocessing INFO [Test epoch=0036]  nevals=18000 	| train_loss=5276.56104 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.44953 	| r_quantile_mean=0.46508 	| r_raw_sum=122.65289 	|  r_raw_mean=0.25237 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18540
MainProcess| 2024-07-22 00:49:04,831,831 multiprocessing INFO [Test epoch=0037]  nevals=18500 	| train_loss=7172.93506 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45863 	| r_quantile_mean=0.51337 	| r_raw_sum=116.72545 	|  r_raw_mean=0.24267 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.20614
MainProcess| 2024-07-22 00:49:05,059,59 multiprocessing INFO [Test epoch=0038]  nevals=19000 	| train_loss=7138.16406 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.45420 	| r_quantile_mean=0.48204 	| r_raw_sum=116.30314 	|  r_raw_mean=0.23931 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.22747
MainProcess| 2024-07-22 00:49:05,256,256 multiprocessing INFO [Test epoch=0039]  nevals=19500 	| train_loss=7090.97119 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.48412 	| r_quantile_mean=0.50056 	| r_raw_sum=123.50769 	|  r_raw_mean=0.25731 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19740
MainProcess| 2024-07-22 00:49:05,445,445 multiprocessing INFO [Test epoch=0040]  nevals=20000 	| train_loss=6573.69775 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.46565 	| r_quantile_mean=0.48457 	| r_raw_sum=122.57255 	|  r_raw_mean=0.25377 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18821
MainProcess| 2024-07-22 00:49:05,445,445 multiprocessing INFO [00:00:00:10.87] Training epoch 40/4000, current best R: 0.7214
MainProcess| 2024-07-22 00:49:05,632,632 multiprocessing INFO [Test epoch=0041]  nevals=20500 	| train_loss=5153.63232 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.47392 	| r_quantile_mean=0.48803 	| r_raw_sum=117.02543 	|  r_raw_mean=0.24380 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18655
MainProcess| 2024-07-22 00:49:05,819,819 multiprocessing INFO [Test epoch=0042]  nevals=21000 	| train_loss=6093.63379 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.46765 	| r_quantile_mean=0.47887 	| r_raw_sum=129.22568 	|  r_raw_mean=0.26590 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18726
MainProcess| 2024-07-22 00:49:06,011,11 multiprocessing INFO [Test epoch=0043]  nevals=21500 	| train_loss=6646.99854 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.44415 	| r_quantile_mean=0.46894 	| r_raw_sum=119.64794 	|  r_raw_mean=0.24772 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19105
MainProcess| 2024-07-22 00:49:06,202,202 multiprocessing INFO [Test epoch=0044]  nevals=22000 	| train_loss=8077.42188 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.46343 	| r_quantile_mean=0.49440 	| r_raw_sum=124.05449 	|  r_raw_mean=0.25266 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19139
MainProcess| 2024-07-22 00:49:06,388,388 multiprocessing INFO [Test epoch=0045]  nevals=22500 	| train_loss=6588.20850 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.49538 	| r_quantile_mean=0.54029 	| r_raw_sum=122.34149 	|  r_raw_mean=0.25225 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18601
MainProcess| 2024-07-22 00:49:06,575,575 multiprocessing INFO [Test epoch=0046]  nevals=23000 	| train_loss=6580.69727 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.46338 	| r_quantile_mean=0.49256 	| r_raw_sum=114.12238 	|  r_raw_mean=0.23775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18627
MainProcess| 2024-07-22 00:49:06,759,759 multiprocessing INFO [Test epoch=0047]  nevals=23500 	| train_loss=6263.75439 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45758 	| r_quantile_mean=0.51379 	| r_raw_sum=115.83421 	|  r_raw_mean=0.24082 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18429
MainProcess| 2024-07-22 00:49:06,951,951 multiprocessing INFO [Test epoch=0048]  nevals=24000 	| train_loss=5857.32080 	| eqs_invalid %=2.20 	| r_best=0.72143 	| quantile=0.44792 	| r_quantile_mean=0.48207 	| r_raw_sum=127.27993 	|  r_raw_mean=0.26029 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19192
MainProcess| 2024-07-22 00:49:07,142,142 multiprocessing INFO [Test epoch=0049]  nevals=24500 	| train_loss=2955.92456 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.44301 	| r_quantile_mean=0.49061 	| r_raw_sum=122.17117 	|  r_raw_mean=0.25399 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19046
MainProcess| 2024-07-22 00:49:07,337,337 multiprocessing INFO [Test epoch=0050]  nevals=25000 	| train_loss=6183.55859 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.45957 	| r_quantile_mean=0.48265 	| r_raw_sum=122.78383 	|  r_raw_mean=0.25527 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19475
MainProcess| 2024-07-22 00:49:07,337,337 multiprocessing INFO [00:00:00:12.76] Training epoch 50/4000, current best R: 0.7214
MainProcess| 2024-07-22 00:49:07,523,523 multiprocessing INFO [Test epoch=0051]  nevals=25500 	| train_loss=3188.23560 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.44803 	| r_quantile_mean=0.50070 	| r_raw_sum=122.40260 	|  r_raw_mean=0.25290 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18660
MainProcess| 2024-07-22 00:49:07,713,713 multiprocessing INFO [Test epoch=0052]  nevals=26000 	| train_loss=6461.74756 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46167 	| r_quantile_mean=0.50530 	| r_raw_sum=127.48081 	|  r_raw_mean=0.26016 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.18993
MainProcess| 2024-07-22 00:49:07,905,905 multiprocessing INFO [Test epoch=0053]  nevals=26500 	| train_loss=7960.96924 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.46393 	| r_quantile_mean=0.50087 	| r_raw_sum=128.95581 	|  r_raw_mean=0.26318 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.19094
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO [Test epoch=0054]  nevals=27000 	| train_loss=7277.07568 	| eqs_invalid %=2.20 	| r_best=1.00000 	| quantile=0.46843 	| r_quantile_mean=0.60582 	| r_raw_sum=124.78341 	|  r_raw_mean=0.25518 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=0.19320
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO [00:00:00:13.52] Training epoch 54/4000, current best R: 1.0000
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-22 00:49:08,098,98 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,101,101 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 00:49:08,101,101 multiprocessing INFO [00:00:00:13.52] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 00:49:08,101,101 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 00:49:08,101,101 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 00:49:08,628,628 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 00:49:08,629,629 multiprocessing INFO 
Priority queue entry 1:
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-22 00:49:08,630,630 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 
Priority queue entry 2:
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Reward: 0.692300447727265
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Traversal: n2,sub,mul,sin,div,x2,sub,sub,x2,add,x1,x1,mul,div,x2,x2,x2,x2,x1
MainProcess| 2024-07-22 00:49:08,631,631 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 
	                      2
	  ⎛            ⎛ x₂ ⎞⎞ 
	  ⎜-x₁ - x₂⋅sin⎜────⎟⎟ 
	  ⎝            ⎝2⋅x₁⎠⎠ 

MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 
Priority queue entry 3:
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 	Reward: 0.6805319411385534
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,632,632 multiprocessing INFO 	Traversal: add,add,n2,x2,n2,x1,cos,sub,x1,add,n2,mul,add,n2,x1,x1,x2,x1
MainProcess| 2024-07-22 00:49:08,633,633 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 
	                 ⎛              2⎞
	    2     2      ⎜  2 ⎛  2     ⎞ ⎟
	  x₁  + x₂  + cos⎝x₂ ⋅⎝x₁  + x₁⎠ ⎠

MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 
Priority queue entry 4:
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Reward: 0.6609841940521602
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Traversal: mul,add,div,div,x2,x1,sin,add,x1,sub,sub,add,x2,x1,x1,x1,x1,x1
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,634,634 multiprocessing INFO 
	     ⎛         x₂    ⎞
	  x₁⋅⎜x₁ + ──────────⎟
	     ⎝     x₁⋅sin(x₂)⎠

MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 
Priority queue entry 5:
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Reward: 0.6217502159179428
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Traversal: add,mul,sub,x1,sin,div,mul,div,x2,x1,x2,x2,x1,add,cos,x1,n2,x2
MainProcess| 2024-07-22 00:49:08,635,635 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 
	     ⎛        ⎛x₂⎞⎞     2          
	  x₁⋅⎜x₁ - sin⎜──⎟⎟ + x₂  + cos(x₁)
	     ⎝        ⎝x₁⎠⎠                

MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 
Priority queue entry 6:
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Reward: 0.5782056568736673
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Traversal: sub,add,add,mul,cos,x1,mul,x2,mul,x2,sin,n2,x1,n2,x2,n2,x1,x1
MainProcess| 2024-07-22 00:49:08,636,636 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 
	    2          2    ⎛  2⎞             2
	  x₁  - x₁ + x₂ ⋅sin⎝x₁ ⎠⋅cos(x₁) + x₂ 

MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 
Priority queue entry 7:
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Reward: 0.5764576150129798
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Traversal: add,n2,x1,add,mul,x2,add,cos,mul,div,x2,add,sub,mul,x2,x1,x1,x2,x2,x2,x1
MainProcess| 2024-07-22 00:49:08,637,637 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 
	                ⎛        ⎛        2      ⎞⎞
	    2           ⎜        ⎜      x₂       ⎟⎟
	  x₁  + x₁ + x₂⋅⎜x₂ + cos⎜───────────────⎟⎟
	                ⎝        ⎝x₁⋅x₂ - x₁ + x₂⎠⎠

MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 
Priority queue entry 8:
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Reward: 0.5671309013236785
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Traversal: add,mul,x2,x2,n2,cos,div,x2,mul,mul,x1,x1,sub,sub,x2,x2,x2
MainProcess| 2024-07-22 00:49:08,639,639 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 
	    2      2⎛ 1 ⎞
	  x₂  + cos ⎜───⎟
	            ⎜  2⎟
	            ⎝x₁ ⎠

MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 
Priority queue entry 9:
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Reward: 0.5639053892928447
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Traversal: add,n2,x2,sin,n2,div,x1,x1
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:49:08,640,640 multiprocessing INFO 
	    2         
	  x₂  + sin(1)

MainProcess| 2024-07-22 00:49:08,641,641 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 00:49:08,642,642 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 00:49:08,642,642 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 00:49:08,642,642 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 00:49:08,705,705 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-004853_0/summary.csv'
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-004853_0
MainProcess| 2024-07-22 00:49:08,852,852 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 00:49:08,853,853 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 00:49:08,853,853 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 00:49:08,853,853 multiprocessing INFO   0
MainProcess| 2024-07-22 00:49:08,853,853 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 00:49:08,853,853 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 00:49:08,853,853 multiprocessing INFO     1: S=000 R=0.721433 <-- [x1**2 + x2*(x2 + sin((-x1 + x2**2/x1)/x1))]
MainProcess| 2024-07-22 00:49:08,854,854 multiprocessing INFO     2: S=000 R=0.692300 <-- [(-x1 - x2*sin(x2/(2*x1)))**2]
MainProcess| 2024-07-22 00:49:08,854,854 multiprocessing INFO     3: S=000 R=0.680532 <-- [x1**2 + x2**2 + cos(x2**2*(x1**2 + x1)**2)]
MainProcess| 2024-07-22 00:49:08,854,854 multiprocessing INFO     4: S=000 R=0.660984 <-- [x1*(x1 + x2/(x1*sin(x2)))]
MainProcess| 2024-07-22 00:49:08,854,854 multiprocessing INFO Pareto Front (5 of 6)____
MainProcess| 2024-07-22 00:49:08,854,854 multiprocessing INFO     0: S=000 R=1.000000 C=21.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 00:49:08,855,855 multiprocessing INFO     1: S=000 R=0.565633 C=11.00 <-- [x1**2*x2/sin(x2)]
MainProcess| 2024-07-22 00:49:08,855,855 multiprocessing INFO     2: S=000 R=0.514932 C=10.00 <-- [(x1 - x2 + sin(x2))**2]
MainProcess| 2024-07-22 00:49:08,855,855 multiprocessing INFO     3: S=000 R=0.496751 C=8.00 <-- [(-x1 + cos(x1))**2]
MainProcess| 2024-07-22 00:49:08,856,856 multiprocessing INFO     4: S=000 R=0.435535 C=6.00 <-- [x1*sin(x1)]
MainProcess| 2024-07-22 00:49:08,856,856 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 00:49:08,856,856 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 00:49:08,856,856 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 14.065670251846313, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 00:49:08,856,856 multiprocessing INFO INFO: Completed run 1 of 1 in 14 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 14.065670251846313, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 00:49:08,856,856 multiprocessing INFO Fin.
MainProcess| 2024-07-22 00:49:08,857,857 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:50:27,715,715 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:50:27,715,715 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:50:27,715,715 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:50:27,716,716 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:50:27,832,832 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 00:50:27,833,833 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 00:50:27,886,886 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 00:50:27,890,890 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 00:50:28,758,758 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 00:50:28,764,764 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-005027', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-005027_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 00:50:31,779,779 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98291 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.48264 	| r_quantile_mean=0.48999 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=3.00831
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO [00:00:00:03.01] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 00:50:31,780,780 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:50:31,918,918 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 00:50:32,104,104 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02002 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.47344 	| r_quantile_mean=0.49624 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.18587
MainProcess| 2024-07-22 00:50:32,104,104 multiprocessing INFO [00:00:00:03.33] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-22 00:50:32,105,105 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:50:32,112,112 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.19336 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.46628 	| r_quantile_mean=0.49914 	| r_raw_sum=129.25510 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.18329
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO [00:00:00:03.52] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:50:32,295,295 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-22 00:50:32,296,296 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:50:32,297,297 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-22 00:50:32,489,489 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5792.71289 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.46473 	| r_quantile_mean=0.47559 	| r_raw_sum=117.54185 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.19165
MainProcess| 2024-07-22 00:50:32,700,700 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.17090 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.47530 	| r_quantile_mean=0.48596 	| r_raw_sum=128.26342 	|  r_raw_mean=0.26283 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.21094
MainProcess| 2024-07-22 00:50:32,789,789 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:52:46,807,807 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:52:46,807,807 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:52:46,807,807 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:52:46,808,808 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:52:46,918,918 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 00:52:46,921,921 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 00:52:46,975,975 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 00:52:46,980,980 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 00:52:47,959,959 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 00:52:47,965,965 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-005246', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-005246_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 00:52:50,848,848 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:56:20,396,396 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:56:20,396,396 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:56:20,396,396 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:56:20,397,397 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:56:20,507,507 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 00:56:20,508,508 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 00:56:20,561,561 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 00:56:20,564,564 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 00:56:21,564,564 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 00:56:21,569,569 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-005620', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-005620_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 00:56:25,596,596 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6528.44531 	| eqs_invalid %=3.40 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-279069844988353511424.00000 	|  r_raw_mean=-885936015836042880.00000 	| r2=0.14531 	| acc_iid=0.00000 	| acc_ood=0.00000 	| nmse_test=3.7039073177930457 	| true_equation_set_count=0 	| s/it=4.02053
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO [00:00:00:04.02] Training epoch 1/4000, current best R: 0.0000
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Reward: 0.0
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Traversal: sin,mul,sub,sub,x2,sub,add,sub,n2,x2,mul,sub,x1,mul,x2,x1,x2,x2,x2,x1,x1
MainProcess| 2024-07-22 00:56:25,597,597 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:56:25,739,739 multiprocessing INFO 
	     ⎛   ⎛        2                        ⎞⎞
	  sin⎝x₁⋅⎝-x₁ - x₂  + x₂⋅(-x₁⋅x₂ + x₁) + x₂⎠⎠

MainProcess| 2024-07-22 00:56:26,920,920 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6477.60107 	| eqs_invalid %=2.60 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-14549433018527.75195 	|  r_raw_mean=-46188676249.29445 	| r2=0.14531 	| acc_iid=0.00000 	| acc_ood=0.00000 	| nmse_test=3.7039073177930457 	| true_equation_set_count=0 	| s/it=1.18142
MainProcess| 2024-07-22 00:56:28,041,41 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=6577.78711 	| eqs_invalid %=1.80 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-14247062900561.74023 	|  r_raw_mean=-43436167379.76141 	| r2=0.14531 	| acc_iid=0.00000 	| acc_ood=0.00000 	| nmse_test=3.7039073177930457 	| true_equation_set_count=0 	| s/it=1.12031
MainProcess| 2024-07-22 00:56:29,196,196 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=6397.98877 	| eqs_invalid %=4.20 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-40193862148858.72656 	|  r_raw_mean=-121799582269.26888 	| r2=0.14531 	| acc_iid=0.00000 	| acc_ood=0.00000 	| nmse_test=3.7039073177930457 	| true_equation_set_count=0 	| s/it=1.15517
MainProcess| 2024-07-22 00:56:29,312,312 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 00:58:53,809,809 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 00:58:53,809,809 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:58:53,809,809 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 00:58:53,811,811 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 00:58:53,927,927 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 00:58:53,928,928 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 00:58:53,990,990 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 00:58:53,994,994 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 00:58:54,968,968 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 00:58:54,974,974 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-005853', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-005853_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6882.07910 	| eqs_invalid %=3.40 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-55813968997670707200.00000 	|  r_raw_mean=-205198415432612896.00000 	| r2=0.22732 	| acc_iid=0.01493 	| acc_ood=0.00000 	| nmse_test=3.524452825499482 	| true_equation_set_count=0 	| s/it=4.08633
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO [00:00:00:04.09] Training epoch 1/4000, current best R: 0.0000
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Reward: 0.0
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Traversal: mul,x1,add,cos,mul,add,n2,x1,add,n2,add,add,sub,div,x2,x1,x2,x2,x2,x1,x2,x2
MainProcess| 2024-07-22 00:58:59,067,67 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 00:58:59,203,203 multiprocessing INFO 
	     ⎛        ⎛   ⎛                    2⎞⎞⎞
	     ⎜        ⎜   ⎜  2        ⎛     x₂⎞ ⎟⎟⎟
	  x₁⋅⎜x₂ + cos⎜x₂⋅⎜x₁  + x₁ + ⎜x₂ + ──⎟ ⎟⎟⎟
	     ⎝        ⎝   ⎝           ⎝     x₁⎠ ⎠⎠⎠

MainProcess| 2024-07-22 00:59:00,648,648 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6827.70068 	| eqs_invalid %=2.00 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-245268746676377622327887933107716986047984392778809344.00000 	|  r_raw_mean=-936140254489990883060141098786874177830443303305216.00000 	| r2=0.22732 	| acc_iid=0.01493 	| acc_ood=0.00000 	| nmse_test=3.524452825499482 	| true_equation_set_count=0 	| s/it=1.44501
MainProcess| 2024-07-22 00:59:01,824,824 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=6503.62646 	| eqs_invalid %=1.80 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-522252.70845 	|  r_raw_mean=-1865.18824 	| r2=0.22732 	| acc_iid=0.01493 	| acc_ood=0.00000 	| nmse_test=3.524452825499482 	| true_equation_set_count=0 	| s/it=1.17633
MainProcess| 2024-07-22 00:59:03,216,216 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=6725.89404 	| eqs_invalid %=4.60 	| r_best=0.00000 	| quantile=0.00000 	| r_quantile_mean=0.00000 	| r_raw_sum=-651200707.22902 	|  r_raw_mean=-2385350.57593 	| r2=0.22732 	| acc_iid=0.01493 	| acc_ood=0.00000 	| nmse_test=3.524452825499482 	| true_equation_set_count=0 	| s/it=1.39134
MainProcess| 2024-07-22 00:59:03,330,330 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:18:08,676,676 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:18:08,676,676 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:18:08,676,676 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:18:08,677,677 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:18:08,786,786 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:18:08,787,787 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:18:08,840,840 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:18:08,844,844 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:18:09,748,748 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:18:09,754,754 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:18:09,761,761 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-211808', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-211808_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6537.44189 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=1.00000 	| r_quantile_mean=1.00000 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.77197
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO [00:00:00:05.77] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:18:15,539,539 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:18:15,565,565 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:18:15,565,565 multiprocessing INFO [00:00:00:05.80] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:18:15,565,565 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:18:15,565,565 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:18:15,742,742 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:18:15,742,742 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:18:15,743,743 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:18:15,744,744 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:18:15,744,744 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:18:15,744,744 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:18:15,807,807 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-211808_0/summary.csv'
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-211808_0
MainProcess| 2024-07-22 21:18:15,945,945 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:18:15,946,946 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:18:15,946,946 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:18:15,946,946 multiprocessing INFO   0
MainProcess| 2024-07-22 21:18:15,946,946 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:18:15,946,946 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:18:15,946,946 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:18:15,947,947 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:18:15,947,947 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:18:15,947,947 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:18:15,947,947 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-22 21:18:15,947,947 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:18:15,948,948 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-22 21:18:15,948,948 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:18:15,948,948 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:18:15,948,948 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.977723836898804, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:18:15,948,948 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.977723836898804, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:18:15,948,948 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:18:15,949,949 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:19:00,505,505 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:19:00,506,506 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:19:00,506,506 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:19:00,507,507 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:19:00,614,614 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:19:00,615,615 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:19:00,668,668 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:19:00,672,672 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:19:01,516,516 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:19:01,523,523 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:19:01,530,530 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-211900', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-211900_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:19:06,894,894 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:20:31,007,7 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:20:31,007,7 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:20:31,007,7 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:20:31,009,9 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:20:31,120,120 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:20:31,122,122 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:20:31,178,178 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:20:31,183,183 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:20:32,040,40 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:20:32,046,46 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 25, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:20:32,052,52 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212031', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212031_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 25, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:20:37,423,423 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:21:33,115,115 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:21:33,115,115 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:21:33,115,115 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:21:33,117,117 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:21:33,226,226 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:21:33,227,227 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:21:33,281,281 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:21:33,285,285 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:21:34,184,184 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:21:34,190,190 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:21:34,196,196 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212133', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212133_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:21:39,990,990 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6204.99365 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=0.37031 	| r_quantile_mean=0.67537 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.78703
MainProcess| 2024-07-22 21:21:39,990,990 multiprocessing INFO [00:00:00:05.79] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:21:39,990,990 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:21:39,991,991 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:21:40,018,18 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:21:40,018,18 multiprocessing INFO [00:00:00:05.81] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:21:40,018,18 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:21:40,018,18 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:21:40,200,200 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:21:40,200,200 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 21:21:40,200,200 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:21:40,200,200 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:21:40,200,200 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:21:40,201,201 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:21:40,201,201 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 21:21:40,201,201 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:21:40,314,314 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 21:21:40,315,315 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:21:40,315,315 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:21:40,315,315 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:21:40,315,315 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:21:40,378,378 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-212133_0/summary.csv'
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-212133_0
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:21:40,519,519 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:21:40,520,520 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:21:40,520,520 multiprocessing INFO   0
MainProcess| 2024-07-22 21:21:40,520,520 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:21:40,520,520 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:21:40,520,520 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:21:40,521,521 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:21:40,521,521 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:21:40,521,521 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:21:40,521,521 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-22 21:21:40,522,522 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:21:40,522,522 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-22 21:21:40,522,522 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:21:40,522,522 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:21:40,523,523 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.112641096115112, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:21:40,523,523 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.112641096115112, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:21:40,523,523 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:21:40,523,523 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:24:14,502,502 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:24:14,503,503 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:24:14,503,503 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:24:14,504,504 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:24:14,610,610 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:24:14,611,611 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:24:14,663,663 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:24:14,667,667 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:24:15,512,512 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:24:15,517,517 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:24:15,522,522 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212414', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212414_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6204.99365 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=0.37031 	| r_quantile_mean=0.67537 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.84082
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO [00:00:00:05.84] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:24:21,370,370 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:24:21,395,395 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:24:21,395,395 multiprocessing INFO [00:00:00:05.87] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:24:21,395,395 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:24:21,395,395 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 21:24:21,575,575 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:24:21,687,687 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 21:24:21,687,687 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:24:21,688,688 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:24:21,688,688 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:24:21,688,688 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:24:21,750,750 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-212414_0/summary.csv'
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-212414_0
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO   0
MainProcess| 2024-07-22 21:24:21,892,892 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:24:21,893,893 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:21,893,893 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:21,893,893 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:21,893,893 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:21,894,894 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:21,894,894 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-22 21:24:21,894,894 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:21,895,895 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-22 21:24:21,895,895 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:24:21,895,895 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:24:21,895,895 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.159544467926025, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:24:21,895,895 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.159544467926025, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:24:21,895,895 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:24:21,896,896 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:24:41,961,961 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:24:41,961,961 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:24:41,961,961 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:24:41,963,963 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:24:42,069,69 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:24:42,070,70 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:24:42,123,123 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:24:42,127,127 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:24:42,968,968 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:24:42,973,973 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:24:42,978,978 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212442', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212442_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6204.99365 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=0.37031 	| r_quantile_mean=0.67537 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.90628
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO [00:00:00:05.91] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:24:48,890,890 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:24:48,915,915 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:24:48,915,915 multiprocessing INFO [00:00:00:05.93] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:24:48,915,915 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:24:48,915,915 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:24:49,096,96 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 21:24:49,097,97 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:24:49,208,208 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 21:24:49,208,208 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:24:49,209,209 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:24:49,209,209 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:24:49,209,209 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:24:49,274,274 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-212442_0/summary.csv'
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-212442_0
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO   0
MainProcess| 2024-07-22 21:24:49,415,415 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:24:49,416,416 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:49,416,416 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:49,416,416 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:49,416,416 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:49,417,417 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:49,417,417 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-22 21:24:49,417,417 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:24:49,417,417 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-22 21:24:49,417,417 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:24:49,417,417 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:24:49,418,418 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.226230144500732, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:24:49,418,418 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.226230144500732, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:24:49,418,418 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:24:49,418,418 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:25:16,395,395 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:25:16,395,395 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:25:16,396,396 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:25:16,397,397 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:25:16,507,507 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:25:16,508,508 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:25:16,561,561 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:25:16,565,565 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:25:17,564,564 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:25:17,569,569 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:25:17,575,575 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212516', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212516_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:25:23,514,514 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:25:52,745,745 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:25:52,746,746 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:25:52,746,746 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:25:52,747,747 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:25:52,855,855 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:25:52,856,856 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:25:52,910,910 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:25:52,914,914 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:25:53,763,763 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:25:53,766,766 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:25:53,770,770 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212552', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212552_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:25:59,230,230 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:26:29,589,589 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:26:29,589,589 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:26:29,589,589 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:26:29,591,591 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:26:29,699,699 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:26:29,700,700 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:26:29,753,753 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:26:29,757,757 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:26:30,776,776 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:26:30,782,782 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:26:30,787,787 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212629', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212629_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:26:36,199,199 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:28:33,072,72 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:28:33,072,72 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:28:33,072,72 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:28:33,073,73 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:28:33,181,181 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:28:33,182,182 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:28:33,236,236 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:28:33,240,240 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:28:34,140,140 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:28:34,146,146 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:28:34,152,152 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212833', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212833_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6204.98291 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=0.48264 	| r_quantile_mean=0.95364 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.49312
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO [00:00:00:05.49] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:28:39,652,652 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:28:39,678,678 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:28:39,678,678 multiprocessing INFO [00:00:00:05.52] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:28:39,678,678 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:28:39,678,678 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 21:28:39,858,858 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:28:40,087,87 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 21:28:40,088,88 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:28:40,088,88 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:28:40,088,88 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:28:40,088,88 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:28:40,152,152 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-212833_0/summary.csv'
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-212833_0
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO   0
MainProcess| 2024-07-22 21:28:40,293,293 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:28:40,294,294 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:28:40,294,294 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:28:40,294,294 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:28:40,294,294 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:28:40,295,295 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:28:40,295,295 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-22 21:28:40,295,295 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.930354595184326, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 5.930354595184326, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:28:40,296,296 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:28:57,790,790 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:28:57,790,790 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:28:57,790,790 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:28:57,792,792 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:28:57,900,900 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:28:57,901,901 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=True model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:28:57,953,953 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:28:57,957,957 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:28:58,894,894 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:28:58,899,899 multiprocessing INFO GP CONFIG : {'verbose': False, 'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}
MainProcess| 2024-07-22 21:28:58,904,904 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-212857', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-212857_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'generations': 25, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:29:04,715,715 multiprocessing INFO [Test epoch=0001]  nevals=9966 	| train_loss=6204.99365 	| eqs_invalid %=3.09 	| r_best=1.00000 	| quantile=0.37031 	| r_quantile_mean=0.67537 	| r_raw_sum=175.52106 	|  r_raw_mean=0.32931 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=5.80634
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO [00:00:00:05.81] Training epoch 1/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Count Off-policy: 1
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Count On-policy: 0
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Originally on Policy: False
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Traversal: add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1
MainProcess| 2024-07-22 21:29:04,716,716 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:29:04,741,741 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:29:04,741,741 multiprocessing INFO [00:00:00:05.83] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:29:04,741,741 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:29:04,741,741 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 21:29:04,920,920 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:29:05,030,30 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 21:29:05,030,30 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:29:05,031,31 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:29:05,031,31 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:29:05,031,31 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:29:05,093,93 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-212857_0/summary.csv'
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-212857_0
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO   0
MainProcess| 2024-07-22 21:29:05,232,232 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:29:05,233,233 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:29:05,233,233 multiprocessing INFO     1: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:29:05,233,233 multiprocessing INFO     2: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:29:05,234,234 multiprocessing INFO     3: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:29:05,234,234 multiprocessing INFO     4: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:29:05,234,234 multiprocessing INFO Pareto Front (2 of 2)____
MainProcess| 2024-07-22 21:29:05,234,234 multiprocessing INFO     0: S=000 R=1.000000 C=7.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO     1: S=000 R=0.500512 C=5.00 <-- [2*x1**2]
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.1222758293151855, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO INFO: Completed run 1 of 1 in 6 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1', 'program': add,sub,mul,x2,x2,mul,sin,sub,x1,x1,n2,sub,x2,x1,n2,x1, 'error_divide': 82, 'error_node_divide': 81, 'error_node_invalid': 1, 'n_epochs': 1, 'n_samples': 9966, 'n_cached': 5088, 't': 6.1222758293151855, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:29:05,235,235 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:30:04,230,230 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:30:04,230,230 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:30:04,230,230 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:30:04,231,231 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:30:04,344,344 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:30:04,345,345 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:30:04,400,400 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:30:04,404,404 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:30:05,255,255 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:30:05,261,261 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-213004', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-213004_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:30:08,243,243 multiprocessing INFO process shutting down
MainProcess| 2024-07-22 21:30:21,952,952 multiprocessing INFO STARTING NEW RUN ==========
MainProcess| 2024-07-22 21:30:21,952,952 multiprocessing INFO SEE LOG AT : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:30:21,952,952 multiprocessing INFO See log at : ./logs/all_Lyapunov_test_dso-fn_d_all_o_01_log.txt
MainProcess| 2024-07-22 21:30:21,954,954 multiprocessing INFO                variables   expression               train_spec test_spec function_set
name                                                                                 
fn_d_all_o_47          2  x1**2+x2**2  {"all":{"U":[-2,2,70]}}      None         Koza
MainProcess| 2024-07-22 21:30:22,062,62 multiprocessing INFO [BASELINE_TESTING NOW] dataset=fn_d_all_o_47 	| baseline=NGGP 	| seed=0 	| data_samples=70 	| noise=0.0
MainProcess| 2024-07-22 21:30:22,063,63 multiprocessing INFO [RUN SETTINGS]: test_dataset=fn_d_all_o_47 training_equations=200000 training_epochs=100 batch_outer_datasets=24 pre_train=False load_pre_trained_path= priority_queue_training=True gp_meld=False model=dso train_path= risk_seeking_pg_train=True
MainProcess| 2024-07-22 21:30:22,116,116 multiprocessing INFO Running model : dso
MainProcess| 2024-07-22 21:30:22,121,121 multiprocessing INFO Function set: ['x1', 'x2', 'add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2']
MainProcess| 2024-07-22 21:30:23,032,32 multiprocessing INFO dso parameters: 284937 	 | trainable : 284937
MainProcess| 2024-07-22 21:30:23,038,38 multiprocessing INFO config: {'experiment': {'logdir': './log', 'seed': 0, 'timestamp': '2024-07-22-213022', 'task_name': 'fn_d_all_o_47', 'save_path': './log/fn_d_all_o_47_2024-07-22-213022_0'}, 'task': {'task_type': 'regression', 'dataset': 'fn_d_all_o_47', 'function_set': ['add', 'sub', 'mul', 'div', 'sin', 'cos', 'n2'], 'metric': 'inv_nrmse', 'metric_params': [1.0], 'extra_metric_test': None, 'extra_metric_test_params': [], 'threshold': 1e-12, 'protected': False, 'reward_noise': 0.0, 'reward_noise_type': 'r', 'normalize_variance': False, 'decision_tree_threshold_set': []}, 'training': {'n_epochs': None, 'n_samples': 2000000, 'batch_size': 100, 'epsilon': None, 'baseline': 'ewma_R', 'alpha': 0.5, 'b_jumpstart': False, 'n_cores_batch': 1, 'complexity': 'token', 'const_optimizer': 'scipy', 'const_params': {'method': 'L-BFGS-B', 'options': {'gtol': 0.001}}, 'verbose': True, 'debug': 0, 'early_stopping': True, 'hof': 100, 'use_memory': False, 'memory_capacity': 1000.0, 'warm_start': None, 'memory_threshold': None, 'save_all_epoch': False, 'save_summary': False, 'save_positional_entropy': False, 'save_pareto_front': True, 'save_cache': False, 'save_cache_r_min': 0.9, 'save_freq': 1, 'save_token_count': False}, 'state_manager': {'observe_action': False, 'observe_parent': True, 'observe_sibling': True, 'observe_dangling': False, 'embedding': False, 'embedding_size': 32}, 'controller': {'max_length': 64, 'cell': 'lstm', 'num_layers': 1, 'num_units': 256, 'initializer': 'zeros', 'learning_rate': 0.001, 'optimizer': 'adam', 'entropy_weight': 0.03, 'entropy_gamma': 0.7, 'pqt': True, 'pqt_k': 10, 'pqt_batch_size': 1, 'pqt_weight': 200.0, 'pqt_use_pg': False, 'summary': False, 'rl_weight': 1.0}, 'gp_meld': {'verbose': False, 'generations': 20, 'p_crossover': 0.5, 'p_mutate': 0.5, 'tournament_size': 5, 'train_n': 50, 'mutate_tree_max': 3}, 'prior': {'relational': {'targets': [], 'effectors': [], 'relationship': None}, 'length': {'min_': 4, 'max_': 30}, 'repeat': {'tokens': 'const', 'min_': None, 'max_': 10}, 'inverse': {}, 'trig': {}, 'const': {}, 'no_inputs': {}, 'uniform_arity': {}, 'soft_length': {'loc': 10, 'scale': 5}}, 'postprocess': {'show_count': 5, 'save_plots': True}, 'model': 'dso', 'function_names_str': 'x1,x2,add,sub,mul,div,sin,cos,n2', 'nesymres_train_config': {'train_path': 'data/datasets/100000', 'val_path': 'data/raw_datasets/200', 'raw_test_path': 'data/raw_datasets/200', 'test_path': 'data/validation', 'model_path': '/local/home/lbiggio/NeuralSymbolicRegressionThatScales/weights/10MCompleted.ckpt', 'wandb': False, 'num_of_workers': 24, 'batch_size': 150, 'epochs': 20, 'val_check_interval': 1.0, 'precision': 16, 'gpu': 1, 'dataset_train': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 2, 'min': -2}}}, 'dataset_val': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'dataset_test': {'total_variables': None, 'total_coefficients': None, 'max_number_of_points': 20, 'type_of_sampling_points': 'constant', 'predict_c': False, 'fun_support': {'max': 1, 'min': -1}, 'constants': {'num_constants': 3, 'additive': {'max': 2, 'min': -2}, 'multiplicative': {'max': 5, 'min': 0.1}}}, 'architecture': {'sinuisodal_embeddings': False, 'dec_pf_dim': 32, 'dec_layers': 1, 'dim_hidden': 32, 'lr': 0.0001, 'dropout': 0, 'num_features': 2, 'ln': True, 'N_p': 0, 'num_inds': 50, 'activation': 'relu', 'bit16': True, 'norm': True, 'linear': False, 'input_normalization': False, 'src_pad_idx': 0, 'trg_pad_idx': 0, 'length_eq': 20, 'n_l_enc': 5, 'mean': 0.5, 'std': 0.5, 'dim_input': 4, 'num_heads': 2, 'output_dim': 10}, 'inference': {'beam_size': 2, 'bfgs': {'activated': True, 'n_restarts': 10, 'add_coefficients_if_not_existing': False, 'normalization_o': False, 'idx_remove': True, 'normalization_type': 'MSE', 'stop_time': 1000000000.0}}}}
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO [Test epoch=0001]  nevals=500 	| train_loss=6204.98877 	| eqs_invalid %=3.40 	| r_best=0.50109 	| quantile=0.40062 	| r_quantile_mean=0.43590 	| r_raw_sum=125.52106 	|  r_raw_mean=0.25988 	| r2=0.57944 	| acc_iid=0.08955 	| acc_ood=0.07463 	| nmse_test=1.0655380977796272 	| true_equation_set_count=0 	| s/it=3.08867
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO [00:00:00:03.09] Training epoch 1/4000, current best R: 0.5011
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Reward: 0.5010942497792767
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Traversal: mul,sub,x1,cos,add,n2,sub,div,sub,x1,x2,mul,n2,x2,x1,x1,x1,x1
MainProcess| 2024-07-22 21:30:26,133,133 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:26,283,283 multiprocessing INFO 
	     ⎛        ⎛                    2⎞⎞
	     ⎜        ⎜     ⎛      x₁ - x₂⎞ ⎟⎟
	  x₁⋅⎜x₁ - cos⎜x₁ + ⎜-x₁ + ───────⎟ ⎟⎟
	     ⎜        ⎜     ⎜            2⎟ ⎟⎟
	     ⎝        ⎝     ⎝       x₁⋅x₂ ⎠ ⎠⎠

MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO [Test epoch=0002]  nevals=1000 	| train_loss=6161.02197 	| eqs_invalid %=2.40 	| r_best=0.51841 	| quantile=0.40743 	| r_quantile_mean=0.44277 	| r_raw_sum=124.40429 	|  r_raw_mean=0.25493 	| r2=0.68170 	| acc_iid=0.13433 	| acc_ood=0.13433 	| nmse_test=0.7349505127772511 	| true_equation_set_count=0 	| s/it=0.27916
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO [00:00:00:03.52] Training epoch 2/4000, current best R: 0.5184
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Reward: 0.5184109505572752
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Traversal: add,n2,x1,n2,sin,mul,div,div,div,div,add,add,mul,div,x1,x1,x1,x1,x1,x2,x2,x2,x2,x1
MainProcess| 2024-07-22 21:30:26,563,563 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:26,569,569 multiprocessing INFO 
	            ⎛    2⎞
	    2      2⎜3⋅x₁ ⎟
	  x₁  + sin ⎜─────⎟
	            ⎜   4 ⎟
	            ⎝ x₂  ⎠

MainProcess| 2024-07-22 21:30:26,880,880 multiprocessing INFO [Test epoch=0003]  nevals=1500 	| train_loss=7122.24707 	| eqs_invalid %=1.60 	| r_best=0.54089 	| quantile=0.39730 	| r_quantile_mean=0.43810 	| r_raw_sum=129.25411 	|  r_raw_mean=0.26271 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.31090
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO [00:00:00:03.84] Training epoch 3/4000, current best R: 0.5409
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Reward: 0.5408908974618302
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Traversal: add,x2,add,n2,x1,mul,sin,x2,x2
MainProcess| 2024-07-22 21:30:26,881,881 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:26,884,884 multiprocessing INFO 
	    2                  
	  x₁  + x₂⋅sin(x₂) + x₂

MainProcess| 2024-07-22 21:30:27,183,183 multiprocessing INFO [Test epoch=0004]  nevals=2000 	| train_loss=5791.66260 	| eqs_invalid %=4.40 	| r_best=0.54089 	| quantile=0.39247 	| r_quantile_mean=0.42658 	| r_raw_sum=117.54209 	|  r_raw_mean=0.24590 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.29861
MainProcess| 2024-07-22 21:30:27,463,463 multiprocessing INFO [Test epoch=0005]  nevals=2500 	| train_loss=7084.22998 	| eqs_invalid %=2.40 	| r_best=0.54089 	| quantile=0.39142 	| r_quantile_mean=0.43232 	| r_raw_sum=127.90671 	|  r_raw_mean=0.26210 	| r2=0.79134 	| acc_iid=0.08955 	| acc_ood=0.17910 	| nmse_test=0.4438458850637919 	| true_equation_set_count=0 	| s/it=0.27959
MainProcess| 2024-07-22 21:30:27,856,856 multiprocessing INFO [Test epoch=0006]  nevals=3000 	| train_loss=7057.41748 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.39254 	| r_quantile_mean=0.44465 	| r_raw_sum=120.17526 	|  r_raw_mean=0.24881 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.39358
MainProcess| 2024-07-22 21:30:27,856,856 multiprocessing INFO [00:00:00:04.81] Training epoch 6/4000, current best R: 0.7214
MainProcess| 2024-07-22 21:30:27,856,856 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-22 21:30:27,857,857 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:27,863,863 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-22 21:30:28,164,164 multiprocessing INFO [Test epoch=0007]  nevals=3500 	| train_loss=7021.17383 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.41422 	| r_quantile_mean=0.43916 	| r_raw_sum=128.26213 	|  r_raw_mean=0.26283 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30112
MainProcess| 2024-07-22 21:30:28,463,463 multiprocessing INFO [Test epoch=0008]  nevals=4000 	| train_loss=6978.06641 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.40455 	| r_quantile_mean=0.44140 	| r_raw_sum=128.47349 	|  r_raw_mean=0.26381 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29870
MainProcess| 2024-07-22 21:30:28,743,743 multiprocessing INFO [Test epoch=0009]  nevals=4500 	| train_loss=7603.93164 	| eqs_invalid %=3.20 	| r_best=0.72143 	| quantile=0.40029 	| r_quantile_mean=0.42963 	| r_raw_sum=129.50745 	|  r_raw_mean=0.26758 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28016
MainProcess| 2024-07-22 21:30:29,019,19 multiprocessing INFO [Test epoch=0010]  nevals=5000 	| train_loss=7156.47217 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.39014 	| r_quantile_mean=0.43040 	| r_raw_sum=121.74037 	|  r_raw_mean=0.24998 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27601
MainProcess| 2024-07-22 21:30:29,019,19 multiprocessing INFO [00:00:00:05.98] Training epoch 10/4000, current best R: 0.7214
MainProcess| 2024-07-22 21:30:29,292,292 multiprocessing INFO [Test epoch=0011]  nevals=5500 	| train_loss=5832.16553 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.40491 	| r_quantile_mean=0.44157 	| r_raw_sum=124.92080 	|  r_raw_mean=0.25704 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27276
MainProcess| 2024-07-22 21:30:29,563,563 multiprocessing INFO [Test epoch=0012]  nevals=6000 	| train_loss=5947.79346 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.40057 	| r_quantile_mean=0.43239 	| r_raw_sum=125.99380 	|  r_raw_mean=0.25713 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27057
MainProcess| 2024-07-22 21:30:29,841,841 multiprocessing INFO [Test epoch=0013]  nevals=6500 	| train_loss=6807.04932 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.38823 	| r_quantile_mean=0.42120 	| r_raw_sum=115.84256 	|  r_raw_mean=0.23885 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27837
MainProcess| 2024-07-22 21:30:30,116,116 multiprocessing INFO [Test epoch=0014]  nevals=7000 	| train_loss=3908.41602 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.40521 	| r_quantile_mean=0.44903 	| r_raw_sum=124.27290 	|  r_raw_mean=0.25623 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27420
MainProcess| 2024-07-22 21:30:30,394,394 multiprocessing INFO [Test epoch=0015]  nevals=7500 	| train_loss=6365.42139 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.39734 	| r_quantile_mean=0.44019 	| r_raw_sum=121.59467 	|  r_raw_mean=0.25280 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27796
MainProcess| 2024-07-22 21:30:30,677,677 multiprocessing INFO [Test epoch=0016]  nevals=8000 	| train_loss=6352.76318 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.40076 	| r_quantile_mean=0.43977 	| r_raw_sum=129.70660 	|  r_raw_mean=0.26471 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28247
MainProcess| 2024-07-22 21:30:30,951,951 multiprocessing INFO [Test epoch=0017]  nevals=8500 	| train_loss=6885.46240 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.39727 	| r_quantile_mean=0.44027 	| r_raw_sum=122.35507 	|  r_raw_mean=0.25124 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27465
MainProcess| 2024-07-22 21:30:31,227,227 multiprocessing INFO [Test epoch=0018]  nevals=9000 	| train_loss=7469.72168 	| eqs_invalid %=1.60 	| r_best=0.72143 	| quantile=0.39900 	| r_quantile_mean=0.43840 	| r_raw_sum=121.29513 	|  r_raw_mean=0.24653 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27546
MainProcess| 2024-07-22 21:30:31,620,620 multiprocessing INFO [Test epoch=0019]  nevals=9500 	| train_loss=7492.60205 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.40264 	| r_quantile_mean=0.42715 	| r_raw_sum=121.43218 	|  r_raw_mean=0.24986 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.39285
MainProcess| 2024-07-22 21:30:31,896,896 multiprocessing INFO [Test epoch=0020]  nevals=10000 	| train_loss=7474.34033 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.40099 	| r_quantile_mean=0.42653 	| r_raw_sum=121.86920 	|  r_raw_mean=0.24821 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27614
MainProcess| 2024-07-22 21:30:31,896,896 multiprocessing INFO [00:00:00:08.85] Training epoch 20/4000, current best R: 0.7214
MainProcess| 2024-07-22 21:30:32,169,169 multiprocessing INFO [Test epoch=0021]  nevals=10500 	| train_loss=6241.52539 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.39486 	| r_quantile_mean=0.44774 	| r_raw_sum=120.16841 	|  r_raw_mean=0.25035 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27285
MainProcess| 2024-07-22 21:30:32,452,452 multiprocessing INFO [Test epoch=0022]  nevals=11000 	| train_loss=6755.67725 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.40381 	| r_quantile_mean=0.44002 	| r_raw_sum=120.54319 	|  r_raw_mean=0.24803 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28211
MainProcess| 2024-07-22 21:30:32,731,731 multiprocessing INFO [Test epoch=0023]  nevals=11500 	| train_loss=7082.99219 	| eqs_invalid %=1.20 	| r_best=0.72143 	| quantile=0.40120 	| r_quantile_mean=0.44081 	| r_raw_sum=126.72220 	|  r_raw_mean=0.25652 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27919
MainProcess| 2024-07-22 21:30:33,008,8 multiprocessing INFO [Test epoch=0024]  nevals=12000 	| train_loss=6260.89600 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.40960 	| r_quantile_mean=0.43904 	| r_raw_sum=133.87194 	|  r_raw_mean=0.27321 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27638
MainProcess| 2024-07-22 21:30:33,286,286 multiprocessing INFO [Test epoch=0025]  nevals=12500 	| train_loss=6171.77393 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.40034 	| r_quantile_mean=0.42810 	| r_raw_sum=119.88896 	|  r_raw_mean=0.24822 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27783
MainProcess| 2024-07-22 21:30:33,560,560 multiprocessing INFO [Test epoch=0026]  nevals=13000 	| train_loss=6245.80225 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.39249 	| r_quantile_mean=0.43497 	| r_raw_sum=125.86806 	|  r_raw_mean=0.25952 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27414
MainProcess| 2024-07-22 21:30:33,837,837 multiprocessing INFO [Test epoch=0027]  nevals=13500 	| train_loss=6236.19580 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.38972 	| r_quantile_mean=0.42927 	| r_raw_sum=125.52291 	|  r_raw_mean=0.25775 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.27686
MainProcess| 2024-07-22 21:30:34,149,149 multiprocessing INFO [Test epoch=0028]  nevals=14000 	| train_loss=7347.32275 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.40290 	| r_quantile_mean=0.44292 	| r_raw_sum=117.52662 	|  r_raw_mean=0.24133 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.31200
MainProcess| 2024-07-22 21:30:34,459,459 multiprocessing INFO [Test epoch=0029]  nevals=14500 	| train_loss=8903.10645 	| eqs_invalid %=4.20 	| r_best=0.72143 	| quantile=0.40352 	| r_quantile_mean=0.43611 	| r_raw_sum=120.87560 	|  r_raw_mean=0.25235 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30986
MainProcess| 2024-07-22 21:30:34,758,758 multiprocessing INFO [Test epoch=0030]  nevals=15000 	| train_loss=7317.34766 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.40741 	| r_quantile_mean=0.43800 	| r_raw_sum=125.10838 	|  r_raw_mean=0.25796 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29869
MainProcess| 2024-07-22 21:30:34,758,758 multiprocessing INFO [00:00:00:11.71] Training epoch 30/4000, current best R: 0.7214
MainProcess| 2024-07-22 21:30:35,052,52 multiprocessing INFO [Test epoch=0031]  nevals=15500 	| train_loss=7033.47754 	| eqs_invalid %=2.40 	| r_best=0.72143 	| quantile=0.38584 	| r_quantile_mean=0.42134 	| r_raw_sum=116.66743 	|  r_raw_mean=0.23907 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29378
MainProcess| 2024-07-22 21:30:35,543,543 multiprocessing INFO [Test epoch=0032]  nevals=16000 	| train_loss=3798.64746 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.39501 	| r_quantile_mean=0.41671 	| r_raw_sum=121.05115 	|  r_raw_mean=0.24908 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.49036
MainProcess| 2024-07-22 21:30:35,844,844 multiprocessing INFO [Test epoch=0033]  nevals=16500 	| train_loss=3115.97461 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.39807 	| r_quantile_mean=0.42972 	| r_raw_sum=120.89089 	|  r_raw_mean=0.25081 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30169
MainProcess| 2024-07-22 21:30:36,147,147 multiprocessing INFO [Test epoch=0034]  nevals=17000 	| train_loss=7247.81543 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.39542 	| r_quantile_mean=0.42365 	| r_raw_sum=119.55657 	|  r_raw_mean=0.24856 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30202
MainProcess| 2024-07-22 21:30:36,446,446 multiprocessing INFO [Test epoch=0035]  nevals=17500 	| train_loss=6026.32764 	| eqs_invalid %=3.60 	| r_best=0.72143 	| quantile=0.40562 	| r_quantile_mean=0.43492 	| r_raw_sum=127.02189 	|  r_raw_mean=0.26353 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29938
MainProcess| 2024-07-22 21:30:36,757,757 multiprocessing INFO [Test epoch=0036]  nevals=18000 	| train_loss=5276.40430 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.40054 	| r_quantile_mean=0.43013 	| r_raw_sum=122.66853 	|  r_raw_mean=0.25240 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.31108
MainProcess| 2024-07-22 21:30:37,062,62 multiprocessing INFO [Test epoch=0037]  nevals=18500 	| train_loss=7173.01221 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.38933 	| r_quantile_mean=0.43139 	| r_raw_sum=116.70403 	|  r_raw_mean=0.24263 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30467
MainProcess| 2024-07-22 21:30:37,360,360 multiprocessing INFO [Test epoch=0038]  nevals=19000 	| train_loss=7138.41553 	| eqs_invalid %=2.60 	| r_best=0.72143 	| quantile=0.39741 	| r_quantile_mean=0.43692 	| r_raw_sum=116.58942 	|  r_raw_mean=0.23940 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29802
MainProcess| 2024-07-22 21:30:37,658,658 multiprocessing INFO [Test epoch=0039]  nevals=19500 	| train_loss=7091.47412 	| eqs_invalid %=4.20 	| r_best=0.72143 	| quantile=0.40415 	| r_quantile_mean=0.45271 	| r_raw_sum=123.15112 	|  r_raw_mean=0.25710 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29737
MainProcess| 2024-07-22 21:30:37,962,962 multiprocessing INFO [Test epoch=0040]  nevals=20000 	| train_loss=6573.46631 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.40805 	| r_quantile_mean=0.44196 	| r_raw_sum=122.50071 	|  r_raw_mean=0.25362 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.30336
MainProcess| 2024-07-22 21:30:37,962,962 multiprocessing INFO [00:00:00:14.92] Training epoch 40/4000, current best R: 0.7214
MainProcess| 2024-07-22 21:30:38,274,274 multiprocessing INFO [Test epoch=0041]  nevals=20500 	| train_loss=5154.03125 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.39918 	| r_quantile_mean=0.43729 	| r_raw_sum=117.01185 	|  r_raw_mean=0.24377 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.31171
MainProcess| 2024-07-22 21:30:38,571,571 multiprocessing INFO [Test epoch=0042]  nevals=21000 	| train_loss=6094.54150 	| eqs_invalid %=2.80 	| r_best=0.72143 	| quantile=0.40661 	| r_quantile_mean=0.44033 	| r_raw_sum=129.14446 	|  r_raw_mean=0.26573 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29714
MainProcess| 2024-07-22 21:30:38,857,857 multiprocessing INFO [Test epoch=0043]  nevals=21500 	| train_loss=6645.80078 	| eqs_invalid %=3.40 	| r_best=0.72143 	| quantile=0.38924 	| r_quantile_mean=0.41516 	| r_raw_sum=119.36662 	|  r_raw_mean=0.24714 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28568
MainProcess| 2024-07-22 21:30:39,147,147 multiprocessing INFO [Test epoch=0044]  nevals=22000 	| train_loss=8077.48535 	| eqs_invalid %=1.80 	| r_best=0.72143 	| quantile=0.39765 	| r_quantile_mean=0.43721 	| r_raw_sum=123.91865 	|  r_raw_mean=0.25238 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28982
MainProcess| 2024-07-22 21:30:39,434,434 multiprocessing INFO [Test epoch=0045]  nevals=22500 	| train_loss=6587.34326 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.40460 	| r_quantile_mean=0.45288 	| r_raw_sum=122.29469 	|  r_raw_mean=0.25215 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28723
MainProcess| 2024-07-22 21:30:39,724,724 multiprocessing INFO [Test epoch=0046]  nevals=23000 	| train_loss=6579.17285 	| eqs_invalid %=4.00 	| r_best=0.72143 	| quantile=0.39066 	| r_quantile_mean=0.43547 	| r_raw_sum=114.17780 	|  r_raw_mean=0.23787 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28984
MainProcess| 2024-07-22 21:30:40,128,128 multiprocessing INFO [Test epoch=0047]  nevals=23500 	| train_loss=6261.98047 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.38658 	| r_quantile_mean=0.43622 	| r_raw_sum=115.83673 	|  r_raw_mean=0.24082 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.40324
MainProcess| 2024-07-22 21:30:40,420,420 multiprocessing INFO [Test epoch=0048]  nevals=24000 	| train_loss=5857.14209 	| eqs_invalid %=2.20 	| r_best=0.72143 	| quantile=0.40181 	| r_quantile_mean=0.43004 	| r_raw_sum=127.02162 	|  r_raw_mean=0.25976 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29261
MainProcess| 2024-07-22 21:30:40,737,737 multiprocessing INFO [Test epoch=0049]  nevals=24500 	| train_loss=2956.29956 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.40048 	| r_quantile_mean=0.43070 	| r_raw_sum=122.19906 	|  r_raw_mean=0.25405 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.31626
MainProcess| 2024-07-22 21:30:41,028,28 multiprocessing INFO [Test epoch=0050]  nevals=25000 	| train_loss=6181.79150 	| eqs_invalid %=3.80 	| r_best=0.72143 	| quantile=0.40197 	| r_quantile_mean=0.43761 	| r_raw_sum=122.54385 	|  r_raw_mean=0.25477 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.29120
MainProcess| 2024-07-22 21:30:41,028,28 multiprocessing INFO [00:00:00:17.98] Training epoch 50/4000, current best R: 0.7214
MainProcess| 2024-07-22 21:30:41,313,313 multiprocessing INFO [Test epoch=0051]  nevals=25500 	| train_loss=3187.57642 	| eqs_invalid %=3.00 	| r_best=0.72143 	| quantile=0.40152 	| r_quantile_mean=0.43709 	| r_raw_sum=122.68108 	|  r_raw_mean=0.25295 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28454
MainProcess| 2024-07-22 21:30:41,602,602 multiprocessing INFO [Test epoch=0052]  nevals=26000 	| train_loss=6460.41260 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.39831 	| r_quantile_mean=0.43792 	| r_raw_sum=127.16601 	|  r_raw_mean=0.25952 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28887
MainProcess| 2024-07-22 21:30:41,889,889 multiprocessing INFO [Test epoch=0053]  nevals=26500 	| train_loss=7961.44531 	| eqs_invalid %=2.00 	| r_best=0.72143 	| quantile=0.38874 	| r_quantile_mean=0.42994 	| r_raw_sum=129.12140 	|  r_raw_mean=0.26351 	| r2=0.94504 	| acc_iid=0.19403 	| acc_ood=0.38806 	| nmse_test=0.1294786473695766 	| true_equation_set_count=0 	| s/it=0.28720
MainProcess| 2024-07-22 21:30:42,179,179 multiprocessing INFO [Test epoch=0054]  nevals=27000 	| train_loss=7276.73047 	| eqs_invalid %=2.20 	| r_best=1.00000 	| quantile=0.39764 	| r_quantile_mean=0.45744 	| r_raw_sum=124.95398 	|  r_raw_mean=0.25553 	| r2=1.00000 	| acc_iid=1.00000 	| acc_ood=1.00000 	| nmse_test=0.0 	| true_equation_set_count=0 	| s/it=0.28989
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO [00:00:00:19.14] Training epoch 54/4000, current best R: 1.0000
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 
	** New best
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-22 21:30:42,180,180 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,183,183 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:30:42,183,183 multiprocessing INFO [00:00:00:19.14] Early stopping criteria met; breaking early.
MainProcess| 2024-07-22 21:30:42,183,183 multiprocessing INFO -- RUNNING EPOCHS END ---------------

MainProcess| 2024-07-22 21:30:42,183,183 multiprocessing INFO -- EVALUATION START ----------------
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 
Priority queue entry 0:
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Reward: 1.0
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Traversal: add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1
MainProcess| 2024-07-22 21:30:42,581,581 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 
	    2     2
	  x₁  + x₂ 

MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 
Priority queue entry 1:
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Reward: 0.7214327138456134
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Traversal: add,n2,x1,mul,add,sin,div,sub,mul,n2,div,x2,sub,x2,sub,x2,x1,x1,x1,x1,x2,x2
MainProcess| 2024-07-22 21:30:42,582,582 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,583,583 multiprocessing INFO 
	           ⎛        ⎛        2⎞⎞
	           ⎜        ⎜      x₂ ⎟⎟
	           ⎜        ⎜-x₁ + ───⎟⎟
	    2      ⎜        ⎜       x₁⎟⎟
	  x₁  + x₂⋅⎜x₂ + sin⎜─────────⎟⎟
	           ⎝        ⎝    x₁   ⎠⎠

MainProcess| 2024-07-22 21:30:42,583,583 multiprocessing INFO 
Priority queue entry 2:
MainProcess| 2024-07-22 21:30:42,583,583 multiprocessing INFO 	Reward: 0.692300447727265
MainProcess| 2024-07-22 21:30:42,584,584 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,584,584 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,584,584 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,584,584 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,584,584 multiprocessing INFO 	Traversal: n2,sub,mul,sin,div,x2,sub,sub,x2,add,x1,x1,mul,div,x2,x2,x2,x2,x1
MainProcess| 2024-07-22 21:30:42,584,584 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 
	                      2
	  ⎛            ⎛ x₂ ⎞⎞ 
	  ⎜-x₁ - x₂⋅sin⎜────⎟⎟ 
	  ⎝            ⎝2⋅x₁⎠⎠ 

MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 
Priority queue entry 3:
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Reward: 0.6805319411385534
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Traversal: add,add,n2,x2,n2,x1,cos,sub,x1,add,n2,mul,add,n2,x1,x1,x2,x1
MainProcess| 2024-07-22 21:30:42,585,585 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 
	                 ⎛              2⎞
	    2     2      ⎜  2 ⎛  2     ⎞ ⎟
	  x₁  + x₂  + cos⎝x₂ ⋅⎝x₁  + x₁⎠ ⎠

MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 
Priority queue entry 4:
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Reward: 0.6609841940521602
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Traversal: mul,add,div,div,x2,x1,sin,add,x1,sub,sub,add,x2,x1,x1,x1,x1,x1
MainProcess| 2024-07-22 21:30:42,586,586 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 
	     ⎛         x₂    ⎞
	  x₁⋅⎜x₁ + ──────────⎟
	     ⎝     x₁⋅sin(x₂)⎠

MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 
Priority queue entry 5:
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Reward: 0.6217502159179428
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Traversal: add,mul,sub,x1,sin,div,mul,div,x2,x1,x2,x2,x1,add,cos,x1,n2,x2
MainProcess| 2024-07-22 21:30:42,587,587 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 
	     ⎛        ⎛x₂⎞⎞     2          
	  x₁⋅⎜x₁ - sin⎜──⎟⎟ + x₂  + cos(x₁)
	     ⎝        ⎝x₁⎠⎠                

MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 
Priority queue entry 6:
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Reward: 0.5782056568736673
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Traversal: sub,add,add,mul,cos,x1,mul,x2,mul,x2,sin,n2,x1,n2,x2,n2,x1,x1
MainProcess| 2024-07-22 21:30:42,589,589 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 
	    2          2    ⎛  2⎞             2
	  x₁  - x₁ + x₂ ⋅sin⎝x₁ ⎠⋅cos(x₁) + x₂ 

MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 
Priority queue entry 7:
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Reward: 0.5764576150129798
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Traversal: add,n2,x1,add,mul,x2,add,cos,mul,div,x2,add,sub,mul,x2,x1,x1,x2,x2,x2,x1
MainProcess| 2024-07-22 21:30:42,590,590 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 
	                ⎛        ⎛        2      ⎞⎞
	    2           ⎜        ⎜      x₂       ⎟⎟
	  x₁  + x₁ + x₂⋅⎜x₂ + cos⎜───────────────⎟⎟
	                ⎝        ⎝x₁⋅x₂ - x₁ + x₂⎠⎠

MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 
Priority queue entry 8:
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Reward: 0.5671309013236785
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Traversal: add,mul,x2,x2,n2,cos,div,x2,mul,mul,x1,x1,sub,sub,x2,x2,x2
MainProcess| 2024-07-22 21:30:42,592,592 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 
	    2      2⎛ 1 ⎞
	  x₂  + cos ⎜───⎟
	            ⎜  2⎟
	            ⎝x₁ ⎠

MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 
Priority queue entry 9:
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Reward: 0.5639053892928447
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Count Off-policy: 0
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Count On-policy: 1
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Originally on Policy: True
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Invalid: False
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Traversal: add,n2,x2,sin,n2,div,x1,x1
MainProcess| 2024-07-22 21:30:42,593,593 multiprocessing INFO 	Expression:
MainProcess| 2024-07-22 21:30:42,594,594 multiprocessing INFO 
	    2         
	  x₂  + sin(1)

MainProcess| 2024-07-22 21:30:42,594,594 multiprocessing INFO -- EVALUATION END ------------------
MainProcess| 2024-07-22 21:30:42,595,595 multiprocessing INFO == TRAINING SEED 0 END ==============
MainProcess| 2024-07-22 21:30:42,595,595 multiprocessing INFO 
== POST-PROCESS START =================
MainProcess| 2024-07-22 21:30:42,595,595 multiprocessing INFO -- LOADING LOGS START ----------------
MainProcess| 2024-07-22 21:30:42,660,660 multiprocessing INFO Successfully loaded Hall of Fame data
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO Successfully loaded Pareto Front data
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO *** WARNING:
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO     --> Can't load summary: [Errno 2] No such file or directory: './log/fn_d_all_o_47_2024-07-22-213022_0/summary.csv'
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO -- LOADING LOGS END ------------------
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO 
-- ANALYZING LOG START --------------
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO Task_____________regression
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO Source path______./log/fn_d_all_o_47_2024-07-22-213022_0
MainProcess| 2024-07-22 21:30:42,811,811 multiprocessing INFO Runs_____________N/A
MainProcess| 2024-07-22 21:30:42,812,812 multiprocessing INFO Max Samples/run__2000000
MainProcess| 2024-07-22 21:30:42,812,812 multiprocessing INFO Found issues:
MainProcess| 2024-07-22 21:30:42,812,812 multiprocessing INFO   0
MainProcess| 2024-07-22 21:30:42,812,812 multiprocessing INFO Hall of Fame (Top 5 of 100)____
MainProcess| 2024-07-22 21:30:42,812,812 multiprocessing INFO     0: S=000 R=1.000000 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:30:42,812,812 multiprocessing INFO     1: S=000 R=0.721433 <-- [x1**2 + x2*(x2 + sin((-x1 + x2**2/x1)/x1))]
MainProcess| 2024-07-22 21:30:42,813,813 multiprocessing INFO     2: S=000 R=0.692300 <-- [(-x1 - x2*sin(x2/(2*x1)))**2]
MainProcess| 2024-07-22 21:30:42,813,813 multiprocessing INFO     3: S=000 R=0.680532 <-- [x1**2 + x2**2 + cos(x2**2*(x1**2 + x1)**2)]
MainProcess| 2024-07-22 21:30:42,813,813 multiprocessing INFO     4: S=000 R=0.660984 <-- [x1*(x1 + x2/(x1*sin(x2)))]
MainProcess| 2024-07-22 21:30:42,813,813 multiprocessing INFO Pareto Front (5 of 6)____
MainProcess| 2024-07-22 21:30:42,813,813 multiprocessing INFO     0: S=000 R=1.000000 C=21.00 <-- [x1**2 + x2**2]
MainProcess| 2024-07-22 21:30:42,814,814 multiprocessing INFO     1: S=000 R=0.565633 C=11.00 <-- [x1**2*x2/sin(x2)]
MainProcess| 2024-07-22 21:30:42,814,814 multiprocessing INFO     2: S=000 R=0.514932 C=10.00 <-- [(x1 - x2 + sin(x2))**2]
MainProcess| 2024-07-22 21:30:42,814,814 multiprocessing INFO     3: S=000 R=0.496751 C=8.00 <-- [(-x1 + cos(x1))**2]
MainProcess| 2024-07-22 21:30:42,815,815 multiprocessing INFO     4: S=000 R=0.435535 C=6.00 <-- [x1*sin(x1)]
MainProcess| 2024-07-22 21:30:42,815,815 multiprocessing INFO -- ANALYZING LOG END ----------------
MainProcess| 2024-07-22 21:30:42,815,815 multiprocessing INFO == POST-PROCESS END ===================
MainProcess| 2024-07-22 21:30:42,815,815 multiprocessing INFO [TEST RESULT] {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 19.551615476608276, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:30:42,815,815 multiprocessing INFO INFO: Completed run 1 of 1 in 20 s | LATEST TEST_RESULT {'seed': 0, 'r': 1.0, 'nmse_test': 0.0, 'nmse_test_noiseless': 0.0, 'success': True, 'expression': '[x1**2 + x2**2]', 'traversal': 'add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1', 'program': add,add,n2,x1,n2,x2,div,mul,x1,mul,cos,x2,sub,x1,x1,x1, 'error_divide': 786, 'error_square': 1, 'error_node_divide': 771, 'error_node_invalid': 15, 'error_node_underflow': 1, 'n_epochs': 54, 'n_samples': 27000, 'n_cached': 26990, 't': 19.551615476608276, 'baseline': 'NGGP', 'run_seed': 0, 'dataset': 'fn_d_all_o_47'}
MainProcess| 2024-07-22 21:30:42,815,815 multiprocessing INFO Fin.
MainProcess| 2024-07-22 21:30:42,816,816 multiprocessing INFO process shutting down
